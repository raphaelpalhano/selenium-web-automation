(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{twz1:function(t,e,i){"use strict";i.r(e),i.d(e,"DemandsModule",function(){return Lc});var n=i("PCNd"),o=i("ofXK"),c=i("Xgew"),a=i("G8OQ"),s=i("e3yB"),r=i("wd/R"),l=i("fXoL"),d=i("tyNb"),b=i("YVyJ"),m=i("zTWc"),u=i("3Pt+"),f=i("C+b+"),p=i("CW9h"),h=i("DVq8"),S=i("/LKV"),v=i("83k4"),g=i("azXh"),F=i("YR47"),T=i("QNEd"),w=i("85JN"),C=i("nNmo");function D(t,e){if(1&t&&(l.Rb(0),l.Tb(1,"div",10),l.Ob(2,"app-input-datepicker",11),l.Sb(),l.Tb(3,"div",10),l.Ob(4,"app-input-datepicker",12),l.Sb(),l.Tb(5,"div",10),l.Ob(6,"app-select-release",13),l.Sb(),l.Tb(7,"div",10),l.Ob(8,"app-select-sprint",14),l.Sb(),l.Qb()),2&t){const t=l.fc();l.Bb(2),l.lc("control",t.form.get("dtInicioSprintDe"))("max",t.form.get("dtInicioSprintAte").value),l.Bb(2),l.lc("control",t.form.get("dtInicioSprintAte"))("min",t.form.get("dtInicioSprintDe").value),l.Bb(2),l.lc("control",t.form.get("release_id"))("idSquad",t.form.get("squad_id").value),l.Bb(2),l.lc("control",t.form.get("sprint_id"))("idRelease",t.form.get("release_id").value)}}let x=(()=>{class t{constructor(t,e,i){this.formBuilder=t,this.selectDevToViewService=e,this.loadingService=i,this.filterEvent=new l.o,this.allocationSquadSelectedChanges=new l.o,this.modelSquad=a.a,this.listAllocationMode=m.a}ngOnInit(){this.loadingService.show(),this.personId=this.selectDevToViewService.getViewLikeDevId(),this.createForm()}createForm(){this.form=this.formBuilder.group({codigosSquad:[this.defaultFilter?this.defaultFilter.codigosSquad:null,[u.t.required]],codigosDesenvolvedor:[this.defaultFilter?this.defaultFilter.codigosDesenvolvedor:null],codigosNivelRisco:[this.defaultFilter?this.defaultFilter.codigosNivelRisco:null],codigosStatus:[this.defaultFilter?this.defaultFilter.codigosStatus:null]})}resetDesenvolvedorIdAndReleaseIdIfExists(){this.form.get("codigosDesenvolvedor")&&this.form.get("codigosDesenvolvedor").reset(),this.form.get("release_id")&&this.form.get("release_id").reset()}disableDesenvolvedorIdAndReleaseIdIfExists(){this.form.get("codigosDesenvolvedor").disable(),this.form.get("release_id")&&this.form.get("release_id").disable()}onAllocationSquadSelected(t){t?(this.selectedAllocationSquad=t,this.selectedAllocationSquad.squad.modelo.modelo_id===this.modelSquad.SPB?(this.addControlsSPB(),this.form.get("release_id").enable()):this.selectedAllocationSquad.squad.modelo.modelo_id===this.modelSquad.KPB&&this.removeControlsSPB()):(this.removeControlsSPB(),this.disableDesenvolvedorIdAndReleaseIdIfExists(),this.selectedAllocationSquad=null)}addControlsSPB(){this.form.addControl("dtInicioSprintDe",new u.e),this.form.addControl("dtInicioSprintAte",new u.e),this.form.addControl("release_id",new u.e({value:null,disabled:!0})),this.form.addControl("sprint_id",new u.e({value:null,disabled:!0}))}removeControlsSPB(){this.subscriptionReleseControl&&this.subscriptionReleseControl.unsubscribe(),this.form.removeControl("dtInicioSprintDe"),this.form.removeControl("dtInicioSprintAte"),this.form.removeControl("release_id"),this.form.removeControl("sprint_id")}filter(){this.filterEvent.emit(this.form.getRawValue()),this.allocationSquadSelectedChanges.emit(this.selectedAllocationSquad)}onAllocationsSquadLoaded(t){if(this.loadingService.hide(),this.defaultFilter&&this.defaultFilter.codigosSquad){const e=t.find(t=>t.squad.squad_id===this.defaultFilter.codigosSquad);e&&(this.selectedAllocationSquad=e)}if(!this.defaultFilter||!this.defaultFilter.codigosDesenvolvedor)if(this.form.get("codigosSquad").value&&this.form.get("codigosDesenvolvedor").value)this.filter();else{const e=t.find(t=>!t.dtFimAlocacao);e&&e.squad&&(this.form.get("codigosSquad").setValue(e.squad.squad_id),this.form.get("codigosDesenvolvedor").setValue(this.personId),this.filter())}}allocationIsFinished(){var t;if(!this.selectedAllocationSquad||!(null===(t=this.selectedAllocationSquad)||void 0===t?void 0:t.dtFimAlocacao))return!1;const e=r().format("YYYY-MM-DD");return r(this.selectedAllocationSquad.dtFimAlocacao).format("YYYY-MM-DD")<e}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(u.d),l.Nb(f.a),l.Nb(p.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-demand-filters"]],inputs:{defaultFilter:"defaultFilter"},outputs:{filterEvent:"filterEvent",allocationSquadSelectedChanges:"allocationSquadSelectedChanges"},decls:13,vars:12,consts:[[3,"formGroup"],[1,"container-fluid"],[1,"row"],[1,"col-lg-6"],[3,"control","idDev","historic","allocationSquadSelected","allocationsLoaded"],["label","Respons\xe1vel",3,"control","idSquad","allocationMode"],[3,"control","multiple"],[3,"control"],[4,"ngIf"],[3,"form","filterEvent"],[1,"col-lg-3"],["label","In\xedcio sprint de",3,"control","max"],["label","At\xe9",3,"control","min"],[3,"control","idSquad"],[3,"control","idRelease"]],template:function(t,e){1&t&&(l.Tb(0,"form",0),l.Tb(1,"div",1),l.Tb(2,"div",2),l.Tb(3,"div",3),l.Tb(4,"app-select-allocation-squad",4),l.bc("allocationSquadSelected",function(t){return e.onAllocationSquadSelected(t)})("allocationsLoaded",function(t){return e.onAllocationsSquadLoaded(t)}),l.Sb(),l.Sb(),l.Tb(5,"div",3),l.Ob(6,"app-select-allocation-dev-by-squad",5),l.Sb(),l.Tb(7,"div",3),l.Ob(8,"app-select-demand-status",6),l.Sb(),l.Tb(9,"div",3),l.Ob(10,"app-select-risk",7),l.Sb(),l.Fc(11,D,9,8,"ng-container",8),l.Sb(),l.Tb(12,"app-filters-buttons",9),l.bc("filterEvent",function(){return e.filter()}),l.Sb(),l.Sb(),l.Sb()),2&t&&(l.lc("formGroup",e.form),l.Bb(4),l.lc("control",e.form.get("codigosSquad"))("idDev",e.personId)("historic",!0),l.Bb(2),l.lc("control",e.form.get("codigosDesenvolvedor"))("idSquad",e.form.get("codigosSquad").value)("allocationMode",e.allocationIsFinished()?e.listAllocationMode.ALL:e.listAllocationMode.CURRENTS),l.Bb(2),l.lc("control",e.form.get("codigosStatus"))("multiple",!0),l.Bb(2),l.lc("control",e.form.get("codigosNivelRisco")),l.Bb(1),l.lc("ngIf",(null==e.selectedAllocationSquad||null==e.selectedAllocationSquad.squad||null==e.selectedAllocationSquad.squad.modelo?null:e.selectedAllocationSquad.squad.modelo.modelo_id)==e.modelSquad.SPB),l.Bb(1),l.lc("form",e.form))},directives:[u.u,u.p,u.h,h.a,S.a,v.a,g.a,o.l,F.a,T.a,w.a,C.a],styles:[""]}),t})();var I=i("zGX+"),E=i("2JvD"),B=i("JX+z"),O=i("zeBE"),R=i("tHDH"),N=i("e7wf"),M=i("DDQA"),k=i("z/S5"),H=i("Kj3r"),y=i("1G5W"),_=i("+0xr"),q=i("STbY"),A=i("XNiG"),P=i("VRyK"),Q=i("BFR3"),L=i("QLLi"),$=i("kh7C"),j=i("xo4q"),U=i("A6Nz"),J=i("7W0O"),Y=i("iZe+"),z=i("JK/P"),V=i("PS72"),K=i("Pu89"),W=i("XiUz"),G=i("dlKe"),X=i("bTqV"),Z=i("NFeN"),tt=i("Dh3D"),et=i("Qu3c"),it=i("kmnG"),nt=i("qFsG"),ot=i("C6S7"),ct=i("zoH9"),at=i("f0Cb"),st=i("9Ovz");function rt(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",13),l.bc("click",function(){return l.xc(t),l.fc().new.emit()}),l.Tb(1,"mat-icon"),l.Hc(2,"add_circle_outline"),l.Sb(),l.Hc(3," NOVA DEMANDA "),l.Sb()}}function lt(t,e){1&t&&(l.Tb(0,"button",14),l.Tb(1,"mat-icon"),l.Hc(2,"info"),l.Sb(),l.Hc(3," ALOCA\xc7\xc3O ENCERRADA "),l.Sb())}function dt(t,e){1&t&&l.Ob(0,"th",39)}function bt(t,e){if(1&t){const t=l.Ub();l.Tb(0,"td",40),l.Tb(1,"button",41),l.bc("click",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Tb(2,"mat-icon"),l.Hc(3,"more_vert"),l.Sb(),l.Sb(),l.Sb()}}function mt(t,e){1&t&&(l.Tb(0,"th",39),l.Hc(1,"#"),l.Sb())}function ut(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.Sb()),2&t){const t=e.index;l.Bb(1),l.Jc(" ",t+1," ")}}function ft(t,e){1&t&&(l.Tb(0,"th",42),l.Hc(1,"Risco"),l.Sb())}function pt(t,e){if(1&t&&(l.Tb(0,"td",40),l.Tb(1,"div",43),l.Tb(2,"mat-icon",44),l.Hc(3," fiber_manual_record "),l.Sb(),l.Sb(),l.Sb()),2&t){const t=e.$implicit,i=l.fc(2);l.Bb(2),l.Cc("color",i.risksTypesService.getColorOfRisk(t.nivelRisco)),l.lc("matTooltip",i.risksTypesService.getDescriptionOfRisk(t.nivelRisco))}}function ht(t,e){1&t&&(l.Tb(0,"th",42),l.Hc(1,"Status"),l.Sb())}function St(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",t.status_demanda," ")}}function vt(t,e){1&t&&(l.Tb(0,"th",42),l.Hc(1,"Squad"),l.Sb())}function gt(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",t.squad," ")}}function Ft(t,e){1&t&&(l.Tb(0,"th",42),l.Hc(1,"Respons\xe1vel"),l.Sb())}function Tt(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",t.responsavel," ")}}function wt(t,e){if(1&t&&(l.Tb(0,"th",42),l.Hc(1," \xa0 "),l.Tb(2,"div",45),l.Tb(3,"mat-form-field",46),l.bc("click",function(t){return t.stopPropagation()})("keydown.space",function(t){return t.stopPropagation()}),l.Tb(4,"mat-label"),l.Hc(5,"T\xedtulo"),l.Sb(),l.Ob(6,"input",47),l.Sb(),l.Sb(),l.Sb()),2&t){const t=l.fc(2);l.Bb(6),l.lc("formControl",t.filtersForm.get("titulo"))}}function Ct(t,e){if(1&t&&(l.Tb(0,"td",48),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.titulo)}}function Dt(t,e){if(1&t&&(l.Tb(0,"th",42),l.Hc(1," \xa0 "),l.Tb(2,"div",45),l.Tb(3,"app-select-technology",49),l.bc("click",function(t){return t.stopPropagation()}),l.Sb(),l.Sb(),l.Sb()),2&t){const t=l.fc(2);l.Bb(3),l.lc("control",t.filtersForm.get("codigosTecnologia"))("multiple",!0)}}function xt(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.tecnologia)}}function It(t,e){if(1&t&&(l.Tb(0,"th",42),l.Hc(1," \xa0 "),l.Tb(2,"div",45),l.Tb(3,"mat-form-field",46),l.bc("click",function(t){return t.stopPropagation()})("keydown.space",function(t){return t.stopPropagation()}),l.Tb(4,"mat-label"),l.Hc(5,"Estimativa"),l.Sb(),l.Ob(6,"input",47),l.Sb(),l.Sb(),l.Sb()),2&t){const t=l.fc(2);l.Bb(6),l.lc("formControl",t.filtersForm.get("estimativa"))}}function Et(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.gc(2,"decimalNumber"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.hc(2,1,t.estimativa)," ")}}function Bt(t,e){if(1&t&&(l.Tb(0,"th",42),l.Hc(1," \xa0 "),l.Tb(2,"div",45),l.Tb(3,"mat-form-field",46),l.bc("click",function(t){return t.stopPropagation()})("keydown.space",function(t){return t.stopPropagation()}),l.Tb(4,"mat-label"),l.Hc(5,"Incurrido"),l.Sb(),l.Ob(6,"input",47),l.Sb(),l.Sb(),l.Sb()),2&t){const t=l.fc(2);l.Bb(6),l.lc("formControl",t.filtersForm.get("incurrido"))}}function Ot(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.gc(2,"decimalNumber"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.hc(2,1,t.incurrido)," ")}}function Rt(t,e){if(1&t&&(l.Tb(0,"th",42),l.Hc(1," \xa0 "),l.Tb(2,"div",45),l.Tb(3,"mat-form-field",46),l.bc("click",function(t){return t.stopPropagation()})("keydown.space",function(t){return t.stopPropagation()}),l.Tb(4,"mat-label"),l.Hc(5,"ETCc"),l.Sb(),l.Ob(6,"input",47),l.Sb(),l.Sb(),l.Sb()),2&t){const t=l.fc(2);l.Bb(6),l.lc("formControl",t.filtersForm.get("etcc"))}}function Nt(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.gc(2,"decimalNumber"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(l.hc(2,1,t.etcc))}}function Mt(t,e){if(1&t&&(l.Tb(0,"th",42),l.Hc(1," \xa0 "),l.Tb(2,"div",45),l.Tb(3,"mat-form-field",46),l.bc("click",function(t){return t.stopPropagation()})("keydown.space",function(t){return t.stopPropagation()}),l.Tb(4,"mat-label"),l.Hc(5,"ETCm"),l.Sb(),l.Ob(6,"input",47),l.Sb(),l.Sb(),l.Sb()),2&t){const t=l.fc(2);l.Bb(6),l.lc("formControl",t.filtersForm.get("etcm"))}}function kt(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.gc(2,"decimalNumber"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(l.hc(2,1,t.etcm))}}function Ht(t,e){if(1&t&&(l.Tb(0,"th",42),l.Hc(1," Recebimento "),l.Tb(2,"div",45),l.Tb(3,"div",50),l.Tb(4,"div",51),l.Ob(5,"app-input-datepicker",52),l.Sb(),l.Tb(6,"div",53),l.Ob(7,"app-input-datepicker",54),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&t){const t=l.fc(2);l.Bb(5),l.lc("control",t.filtersForm.get("dtInicioRecebimento"))("max",t.filtersForm.get("dtFimRecebimento").value),l.Bb(2),l.lc("control",t.filtersForm.get("dtFimRecebimento"))("min",t.filtersForm.get("dtInicioRecebimento").value)}}function yt(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtRecebimento,"dd/MM/yy")," ")}}function _t(t,e){if(1&t&&(l.Tb(0,"th",42),l.Hc(1," In\xedcio plan. "),l.Tb(2,"div",45),l.Tb(3,"div",50),l.Tb(4,"div",51),l.Ob(5,"app-input-datepicker",52),l.Sb(),l.Tb(6,"div",53),l.Ob(7,"app-input-datepicker",54),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&t){const t=l.fc(2);l.Bb(5),l.lc("control",t.filtersForm.get("dtInicioEntrada"))("max",t.filtersForm.get("dtFimEntrada").value),l.Bb(2),l.lc("control",t.filtersForm.get("dtFimEntrada"))("min",t.filtersForm.get("dtInicioEntrada").value)}}function qt(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtInicioPlanejamento,"dd/MM/yy")," ")}}function At(t,e){if(1&t&&(l.Tb(0,"th",42),l.Hc(1," Fim plan. "),l.Tb(2,"div",45),l.Tb(3,"div",50),l.Tb(4,"div",51),l.Ob(5,"app-input-datepicker",52),l.Sb(),l.Tb(6,"div",53),l.Ob(7,"app-input-datepicker",54),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&t){const t=l.fc(2);l.Bb(5),l.lc("control",t.filtersForm.get("dtInicioEntregaAcordada"))("max",t.filtersForm.get("dtFimEntregaAcordada").value),l.Bb(2),l.lc("control",t.filtersForm.get("dtFimEntregaAcordada"))("min",t.filtersForm.get("dtInicioEntregaAcordada").value)}}function Pt(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtFimPlanejamento,"dd/MM/yy")," ")}}function Qt(t,e){if(1&t&&(l.Tb(0,"th",42),l.Hc(1," In\xedcio real "),l.Tb(2,"div",45),l.Tb(3,"div",50),l.Tb(4,"div",51),l.Ob(5,"app-input-datepicker",52),l.Sb(),l.Tb(6,"div",53),l.Ob(7,"app-input-datepicker",54),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&t){const t=l.fc(2);l.Bb(5),l.lc("control",t.filtersForm.get("dtInicioComecoExecucao"))("max",t.filtersForm.get("dtFimComecoExecucao").value),l.Bb(2),l.lc("control",t.filtersForm.get("dtFimComecoExecucao"))("min",t.filtersForm.get("dtInicioComecoExecucao").value)}}function Lt(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtInicioReal,"dd/MM/yy")," ")}}function $t(t,e){if(1&t&&(l.Tb(0,"th",42),l.Hc(1," Entrega real "),l.Tb(2,"div",45),l.Tb(3,"div",50),l.Tb(4,"div",51),l.Ob(5,"app-input-datepicker",52),l.Sb(),l.Tb(6,"div",53),l.Ob(7,"app-input-datepicker",54),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&t){const t=l.fc(2);l.Bb(5),l.lc("control",t.filtersForm.get("dtInicioEntregaReal"))("max",t.filtersForm.get("dtFimEntregaReal").value),l.Bb(2),l.lc("control",t.filtersForm.get("dtFimEntregaReal"))("min",t.filtersForm.get("dtInicioEntregaReal").value)}}function jt(t,e){if(1&t&&(l.Tb(0,"td",40),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtEntregaReal,"dd/MM/yy")," ")}}function Ut(t,e){1&t&&l.Ob(0,"tr",55)}function Jt(t,e){if(1&t){const t=l.Ub();l.Tb(0,"tr",56),l.bc("contextmenu",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Sb()}}function Yt(t,e){if(1&t){const t=l.Ub();l.Tb(0,"table",15),l.bc("matSortChange",function(e){return l.xc(t),l.fc().sort(e)}),l.Rb(1,16),l.Fc(2,dt,1,0,"th",17),l.Fc(3,bt,4,0,"td",18),l.Qb(),l.Rb(4,19),l.Fc(5,mt,2,0,"th",17),l.Fc(6,ut,2,1,"td",18),l.Qb(),l.Rb(7,20),l.Fc(8,ft,2,0,"th",21),l.Fc(9,pt,4,3,"td",18),l.Qb(),l.Rb(10,22),l.Fc(11,ht,2,0,"th",21),l.Fc(12,St,2,1,"td",18),l.Qb(),l.Rb(13,23),l.Fc(14,vt,2,0,"th",21),l.Fc(15,gt,2,1,"td",18),l.Qb(),l.Rb(16,24),l.Fc(17,Ft,2,0,"th",21),l.Fc(18,Tt,2,1,"td",18),l.Qb(),l.Rb(19,25),l.Fc(20,wt,7,1,"th",21),l.Fc(21,Ct,2,1,"td",26),l.Qb(),l.Rb(22,27),l.Fc(23,Dt,4,2,"th",21),l.Fc(24,xt,2,1,"td",18),l.Qb(),l.Rb(25,28),l.Fc(26,It,7,1,"th",21),l.Fc(27,Et,3,3,"td",18),l.Qb(),l.Rb(28,29),l.Fc(29,Bt,7,1,"th",21),l.Fc(30,Ot,3,3,"td",18),l.Qb(),l.Rb(31,30),l.Fc(32,Rt,7,1,"th",21),l.Fc(33,Nt,3,3,"td",18),l.Qb(),l.Rb(34,31),l.Fc(35,Mt,7,1,"th",21),l.Fc(36,kt,3,3,"td",18),l.Qb(),l.Rb(37,32),l.Fc(38,Ht,8,4,"th",21),l.Fc(39,yt,3,4,"td",18),l.Qb(),l.Rb(40,33),l.Fc(41,_t,8,4,"th",21),l.Fc(42,qt,3,4,"td",18),l.Qb(),l.Rb(43,34),l.Fc(44,At,8,4,"th",21),l.Fc(45,Pt,3,4,"td",18),l.Qb(),l.Rb(46,35),l.Fc(47,Qt,8,4,"th",21),l.Fc(48,Lt,3,4,"td",18),l.Qb(),l.Rb(49,36),l.Fc(50,$t,8,4,"th",21),l.Fc(51,jt,3,4,"td",18),l.Qb(),l.Fc(52,Ut,1,0,"tr",37),l.Fc(53,Jt,1,0,"tr",38),l.Sb()}if(2&t){const t=l.fc();l.lc("dataSource",t.dataSource)("matSortActive",t.sortBy)("matSortDirection",t.sortType),l.Bb(52),l.lc("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),l.Bb(1),l.lc("matRowDefColumns",t.displayedColumns)}}function zt(t,e){1&t&&l.Ob(0,"app-loading-spinner")}function Vt(t,e){1&t&&l.Ob(0,"app-simple-message",57)}function Kt(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",60),l.bc("click",function(){l.xc(t);const e=l.fc(2).item;return l.fc().edit.emit(e)}),l.Tb(1,"mat-icon"),l.Hc(2,"edit"),l.Sb(),l.Hc(3," Editar demanda "),l.Sb()}}const Wt=function(t){return{item:t}};function Gt(t,e){if(1&t&&(l.Tb(0,"button",62),l.Tb(1,"mat-icon"),l.Hc(2,"more_vert"),l.Sb(),l.Hc(3," Mais op\xe7\xf5es "),l.Sb()),2&t){const t=l.fc(2).item;l.fc();const e=l.uc(14);l.lc("matMenuTriggerFor",e)("matMenuTriggerData",l.oc(2,Wt,t))}}function Xt(t,e){if(1&t){const t=l.Ub();l.Rb(0),l.Tb(1,"button",60),l.bc("click",function(){l.xc(t);const e=l.fc().item;return l.fc().view.emit(e)}),l.Tb(2,"mat-icon"),l.Hc(3,"remove_red_eye"),l.Sb(),l.Hc(4," Visualizar demanda "),l.Sb(),l.Fc(5,Kt,4,0,"button",58),l.Fc(6,Gt,4,4,"button",61),l.Ob(7,"mat-divider"),l.Qb()}if(2&t){const t=l.fc().item;l.Bb(5),l.lc("ngIf",t.editavel),l.Bb(1),l.lc("ngIf",t)}}function Zt(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",60),l.bc("click",function(){return l.xc(t),l.fc(2).new.emit()}),l.Tb(1,"mat-icon"),l.Hc(2,"add_circle_outline"),l.Sb(),l.Hc(3," Nova demanda "),l.Sb()}}function te(t,e){if(1&t&&(l.Fc(0,Xt,8,2,"ng-container",6),l.Fc(1,Zt,4,0,"button",58),l.Tb(2,"button",59),l.Tb(3,"mat-icon"),l.Hc(4,"filter_list"),l.Sb(),l.Hc(5," Filtros "),l.Sb()),2&t){const t=e.item,i=l.fc(),n=l.uc(17);l.lc("ngIf",t),l.Bb(1),l.lc("ngIf",i.permissionsService.hasPermission("ROLE_TASKS_CREATE")&&i.showNewButton&&i.allocationIsActive),l.Bb(1),l.lc("matMenuTriggerFor",n)}}function ee(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",60),l.bc("click",function(){l.xc(t);const e=l.fc().item;return l.fc().openRisksModal(e)}),l.Hc(1,"Riscos"),l.Sb()}}function ie(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",60),l.bc("click",function(){l.xc(t);const i=e.item;return l.fc().openDiaryModal(i)}),l.Hc(1,"Di\xe1rios"),l.Sb(),l.Tb(2,"button",60),l.bc("click",function(){l.xc(t);const i=e.item;return l.fc().openBlockModal(i)}),l.Hc(3,"Bloqueios"),l.Sb(),l.Tb(4,"button",60),l.bc("click",function(){l.xc(t);const i=e.item;return l.fc().openDefectsModal(i)}),l.Hc(5,"Defeitos"),l.Sb(),l.Fc(6,ee,2,0,"button",58)}if(2&t){const t=l.fc();l.Bb(6),l.lc("ngIf",t.riskMode)}}function ne(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",60),l.bc("click",function(){return l.xc(t),l.fc().filtersForm.reset()}),l.Hc(1,"Limpar todos filtros"),l.Sb()}}let oe=(()=>{class t{constructor(t,e,i,n,o,c,a,s,r,d,b,m,u,f){this.demandsService=t,this.messageService=e,this.utilsService=i,this.diaryService=n,this.risksService=o,this.loadingService=c,this.paramsService=a,this.simpleRisksService=s,this.modalService=r,this.loggedUserService=d,this.changeDetectorRef=b,this.formBuilder=m,this.permissionsService=u,this.risksTypesService=f,this.showNewButton=!0,this.allocationIsActive=!0,this.view=new l.o,this.edit=new l.o,this.new=new l.o,this.pageSize=10,this.pageIndex=0,this.sortBy="dtRecebimento",this.sortType="desc",this.totalElements=0,this.displayedColumns=["actions","rowNumber","risco","status_demanda","squad","responsavel","titulo","tecnologia","estimativa","incurrido","etcc","etcm","dtrecebimento","dtentrada","dtentrega_acordada","dtinicio_real","dtfim_real"],this.isLoading=!1,this.contextMenuPosition=new k.a,this.unsubscribeNotifier=new A.a}ngOnInit(){this.getRiskMode(),this.listenToCallRefresh(),this.listenFilters()}ngOnDestroy(){this.unsubscribeNotifier.next(),this.unsubscribeNotifier.complete()}ngOnChanges(){this.createFiltersForm(),this.filters&&(this.pageIndex=0,this.dataSource=new _.k([]),this.list(0))}createFiltersForm(){this.filtersForm=this.formBuilder.group({titulo:[""],codigosTecnologia:[[]],estimativa:[""],incurrido:[""],etcm:[""],etcc:[""],dtInicioRecebimento:[null],dtFimRecebimento:[null],dtInicioEntrada:[null],dtFimEntrada:[null],dtInicioEntregaAcordada:[null],dtFimEntregaAcordada:[null],dtInicioComecoExecucao:[null],dtFimComecoExecucao:[null],dtInicioEntregaReal:[null],dtFimEntregaReal:[null]})}listenFilters(){this.filtersForm.valueChanges.pipe(Object(H.a)(250),Object(y.a)(this.unsubscribeNotifier)).subscribe(()=>this.list(0))}listenToCallRefresh(){Object(P.a)(this.diaryService.diaryChanges,this.risksService.risksChanges,this.simpleRisksService.risksChanges).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(()=>this.ngOnChanges())}onContextMenu(t,e){this.contextMenuPosition=this.utilsService.openContextMenu(t,this.contextMenu,{item:e})}getRiskMode(){this.loadingService.show(),this.paramsService.getParamByLineAndKey(this.loggedUserService.getLineId(),"PR_DEMANDA_TIPO_RISCO").pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>this.riskMode=t[0]&&t[0].valor===M.a.COMPLETE?M.a.COMPLETE:M.a.SIMPLE,()=>this.messageService.snackMessage("Erro ao riscos!","error")).add(()=>this.loadingService.hide())}sort(t){this.sortBy=t.active,this.sortType=t.direction,this.list(0)}list(t){const e=Object.assign(this.filtersForm.value,this.filters);0===t&&(this.dataSource=new _.k([])),this.pageIndex=t,this.isLoading=!0,this.changeDetectorRef.detectChanges(),this.demandsService.listFilteredPaginable(this.pageIndex,this.pageSize,this.sortBy,this.sortType,e).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{this.dataSource=new _.k(this.dataSource.data.concat(t.content)),this.totalElements=t.totalElements},()=>{this.messageService.snackMessage("Erro ao listar demandas!","error"),this.dataSource=new _.k([])}).add(()=>{this.isLoading=!1,this.changeDetectorRef.detectChanges()})}openBlockModal(t){this.modalService.open(N.a,{demand:t,allowsCreate:t.editavel,allowsEdit:t.editavel,allowsRemove:t.editavel},{width:"50vw",maxWidth:"50vw"})}openDefectsModal(t){this.modalService.open(R.a,{demand:t,allowsCreate:t.editavel,allowsEdit:t.editavel,allowsRemove:t.editavel},{width:"50vw",maxWidth:"50vw"})}openDiaryModal(t){this.modalService.open(O.a,{demand:t,allowsCreate:t.editavel,allowsEdit:t.editavel,allowsRemove:t.editavel},{width:"50vw",maxWidth:"50vw"})}openRisksModal(t){this.riskMode===M.a.COMPLETE?this.modalService.open(B.a,{demand:t}):this.riskMode===M.a.SIMPLE&&this.modalService.open(E.a,{demand:t},{width:"50vw",maxWidth:"50vw"})}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(Q.a),l.Nb(L.a),l.Nb($.a),l.Nb(j.a),l.Nb(U.a),l.Nb(p.a),l.Nb(J.a),l.Nb(Y.a),l.Nb(z.a),l.Nb(V.a),l.Nb(l.h),l.Nb(u.d),l.Nb(b.a),l.Nb(K.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-demands-list"]],viewQuery:function(t,e){if(1&t&&l.Lc(q.e,!0),2&t){let t;l.tc(t=l.cc())&&(e.contextMenu=t.first)}},inputs:{filters:"filters",showNewButton:"showNewButton",allocationIsActive:"allocationIsActive"},outputs:{view:"view",edit:"edit",new:"new"},features:[l.zb],decls:19,vars:15,consts:[[3,"fxLayoutAlign"],["mat-button","","mat-raised-button","","class","btn btn-success",3,"click",4,"ngIf"],["mat-button","","mat-raised-button","","class","btn btn-warning","disabled","",4,"ngIf"],[1,"table-count"],["infinite-scroll","",1,"wrapper-table-scrolling",3,"scrollWindow","scrolled","contextmenu"],["mat-table","","matSort","",3,"dataSource","matSortActive","matSortDirection","matSortChange",4,"ngIf"],[4,"ngIf"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["message","Nenhuma demanda para estes filtros.",4,"ngIf"],["contextMenu","matMenu"],["matMenuContent",""],["moreOptionsMenu","matMenu"],["filterMenu","matMenu"],["mat-button","","mat-raised-button","",1,"btn","btn-success",3,"click"],["mat-button","","mat-raised-button","","disabled","",1,"btn","btn-warning"],["mat-table","","matSort","",3,"dataSource","matSortActive","matSortDirection","matSortChange"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","rowNumber"],["matColumnDef","risco"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","status_demanda"],["matColumnDef","squad"],["matColumnDef","responsavel"],["matColumnDef","titulo"],["mat-cell","","class","font-weight-bold",4,"matCellDef"],["matColumnDef","tecnologia"],["matColumnDef","estimativa"],["matColumnDef","incurrido"],["matColumnDef","etcc"],["matColumnDef","etcm"],["matColumnDef","dtrecebimento"],["matColumnDef","dtentrada"],["matColumnDef","dtentrega_acordada"],["matColumnDef","dtinicio_real"],["matColumnDef","dtfim_real"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"contextmenu",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-header-cell","","mat-sort-header",""],["fxLayoutAlign","start center"],[3,"matTooltip"],[1,"mat-header-cell-filter"],["appearance","outline","color","primary",3,"click","keydown.space"],["matInput","",3,"formControl"],["mat-cell","",1,"font-weight-bold"],["label","Tecnologia",3,"control","multiple","click"],[1,"row"],[1,"col-6","pr-0"],["label","In\xedcio",3,"control","max"],[1,"col-6"],["label","Fim",3,"control","min"],["mat-header-row",""],["mat-row","",3,"contextmenu"],["message","Nenhuma demanda para estes filtros."],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor","matMenuTriggerData",4,"ngIf"],["mat-menu-item","",3,"matMenuTriggerFor","matMenuTriggerData"]],template:function(t,e){if(1&t&&(l.Tb(0,"div",0),l.Fc(1,rt,4,0,"button",1),l.Fc(2,lt,4,0,"button",2),l.Tb(3,"p",3),l.Hc(4),l.Sb(),l.Sb(),l.Tb(5,"div",4),l.bc("scrolled",function(){return e.list(e.pageIndex+1)})("contextmenu",function(t){return e.onContextMenu(t)}),l.Fc(6,Yt,54,6,"table",5),l.Fc(7,zt,1,0,"app-loading-spinner",6),l.Ob(8,"div",7),l.Fc(9,Vt,1,0,"app-simple-message",8),l.Sb(),l.Tb(10,"mat-menu",null,9),l.Fc(12,te,6,3,"ng-template",10),l.Sb(),l.Tb(13,"mat-menu",null,11),l.Fc(15,ie,7,1,"ng-template",10),l.Sb(),l.Tb(16,"mat-menu",null,12),l.Fc(18,ne,2,0,"ng-template",10),l.Sb()),2&t){const t=l.uc(11);l.mc("fxLayoutAlign","",e.permissionsService.hasPermission("ROLE_TASKS_CREATE")&&e.showNewButton?"space-between":"end"," center my-2"),l.Bb(1),l.lc("ngIf",e.permissionsService.hasPermission("ROLE_TASKS_CREATE")&&e.showNewButton&&e.allocationIsActive),l.Bb(1),l.lc("ngIf",e.permissionsService.hasPermission("ROLE_TASKS_CREATE")&&e.showNewButton&&!e.allocationIsActive),l.Bb(2),l.Jc("Total de registros: ",e.totalElements,""),l.Bb(1),l.Cc("max-height","calc(100vh - 410px)"),l.lc("scrollWindow",!1),l.Bb(1),l.lc("ngIf",e.dataSource),l.Bb(1),l.lc("ngIf",e.isLoading),l.Bb(1),l.Cc("left",e.contextMenuPosition.x)("top",e.contextMenuPosition.y),l.lc("matMenuTriggerFor",t),l.Bb(1),l.lc("ngIf",0==(null==e.dataSource?null:e.dataSource.data.length)&&!e.isLoading)}},directives:[W.a,o.l,G.a,q.e,q.a,q.b,X.b,Z.a,_.j,tt.a,_.c,_.e,_.b,_.g,_.i,_.d,_.a,tt.b,et.a,it.c,it.f,nt.b,u.c,u.o,u.f,ot.a,T.a,_.f,_.h,ct.a,I.a,q.c,at.a],pipes:[st.a,o.e],styles:[""],changeDetection:0}),t})();var ce=i("e3Ai"),ae=i("tk/3"),se=i("yJW+");let re=(()=>{class t{constructor(t,e){this.http=t,this.environmentService=e}getWorkBreakdown(t){const e={};t.dtInicioSprintDe&&(e.dtInicioSprintDe=r(t.dtInicioSprintDe).format("YYYY-MM-DD"),delete t.dtInicioSprintDe),t.dtInicioSprintAte&&(e.dtInicioSprintAte=r(t.dtInicioSprintAte).format("YYYY-MM-DD"),delete t.dtInicioSprintAte);for(const i in t)null!=t[i]&&(e[i]=t[i]);return this.http.get(this.environmentService.getAPI()+"/demandas/workbreakdown",{params:e})}}return t.\u0275fac=function(e){return new(e||t)(l.Xb(ae.b),l.Xb(se.a))},t.\u0275prov=l.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var le=i("PqYM"),de=i("IzEk");let be=(()=>{class t{constructor(){this.onSave=new A.a}setSidenav(t){this.sidenav=t}openForm(t,e,i,n){this.closeForm(),Object(le.a)(10).pipe(Object(de.a)(1)).subscribe(()=>{this.typeForm=t,this.item=e,this.formEnabled=i,this.data=n,this.sidenav.open()})}closeForm(){this.sidenav.close(),this.typeForm=null,this.formEnabled=null,this.item=null,this.data=null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=l.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var me=function(t){return t[t.RELEASE=1]="RELEASE",t[t.SPRINT=2]="SPRINT",t[t.STORY=3]="STORY",t[t.DIARY=4]="DIARY",t[t.DEFECT=5]="DEFECT",t[t.BLOCK=6]="BLOCK",t}({}),ue=i("G8zh"),fe=i("XhcP"),pe=i("znSr"),he=i("R0Ic"),Se=i("VQGR"),ve=i("nAk8"),ge=i("ouhe");function Fe(t,e){1&t&&l.Ob(0,"th",22)}function Te(t,e){if(1&t){const t=l.Ub();l.Tb(0,"td",23),l.Tb(1,"button",24),l.bc("click",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Tb(2,"mat-icon"),l.Hc(3,"more_vert"),l.Sb(),l.Sb(),l.Sb()}}function we(t,e){1&t&&l.Ob(0,"th",22)}function Ce(t,e){1&t&&(l.Tb(0,"td",25),l.Ob(1,"img",26),l.Sb())}function De(t,e){1&t&&(l.Tb(0,"th",22),l.Hc(1,"#"),l.Sb())}function xe(t,e){if(1&t&&(l.Tb(0,"td",23),l.Hc(1),l.Sb()),2&t){const t=e.index;l.Bb(1),l.Jc(" ",t+1," ")}}function Ie(t,e){1&t&&(l.Tb(0,"th",22),l.Hc(1,"Ocorr\xeancia"),l.Sb())}function Ee(t,e){if(1&t&&(l.Tb(0,"td",23),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtOcorrencia,"dd/MM/yy")," ")}}function Be(t,e){1&t&&(l.Tb(0,"th",22),l.Hc(1,"Classe"),l.Sb())}function Oe(t,e){if(1&t&&(l.Tb(0,"td",27),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.classeServico.descricao)}}function Re(t,e){1&t&&(l.Tb(0,"th",22),l.Hc(1,"Descri\xe7\xe3o"),l.Sb())}function Ne(t,e){if(1&t&&(l.Tb(0,"td",23),l.Tb(1,"span",28),l.Hc(2),l.gc(3,"maxLength"),l.Sb(),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.lc("matTooltip",t.descricao),l.Bb(1),l.Jc(" ",l.ic(3,2,t.descricao,200)," ")}}function Me(t,e){1&t&&(l.Tb(0,"th",22),l.Hc(1,"Horas"),l.Sb())}function ke(t,e){if(1&t&&(l.Tb(0,"td",23),l.Hc(1),l.gc(2,"decimalNumber"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(l.hc(2,1,t.horas))}}function He(t,e){1&t&&(l.Tb(0,"th",22),l.Hc(1,"ETCm"),l.Sb())}function ye(t,e){if(1&t&&(l.Tb(0,"td",23),l.Hc(1),l.gc(2,"decimalNumber"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(l.hc(2,1,t.etcm))}}function _e(t,e){1&t&&l.Ob(0,"tr",29)}function qe(t,e){if(1&t){const t=l.Ub();l.Tb(0,"tr",30),l.bc("contextmenu",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Sb()}}function Ae(t,e){if(1&t&&(l.Tb(0,"div",6),l.Tb(1,"table",7),l.Rb(2,8),l.Fc(3,Fe,1,0,"th",9),l.Fc(4,Te,4,0,"td",10),l.Qb(),l.Rb(5,11),l.Fc(6,we,1,0,"th",9),l.Fc(7,Ce,2,0,"td",12),l.Qb(),l.Rb(8,13),l.Fc(9,De,2,0,"th",9),l.Fc(10,xe,2,1,"td",10),l.Qb(),l.Rb(11,14),l.Fc(12,Ie,2,0,"th",9),l.Fc(13,Ee,3,4,"td",10),l.Qb(),l.Rb(14,15),l.Fc(15,Be,2,0,"th",9),l.Fc(16,Oe,2,1,"td",16),l.Qb(),l.Rb(17,17),l.Fc(18,Re,2,0,"th",9),l.Fc(19,Ne,4,5,"td",10),l.Qb(),l.Rb(20,18),l.Fc(21,Me,2,0,"th",9),l.Fc(22,ke,3,3,"td",10),l.Qb(),l.Rb(23,19),l.Fc(24,He,2,0,"th",9),l.Fc(25,ye,3,3,"td",10),l.Qb(),l.Fc(26,_e,1,0,"tr",20),l.Fc(27,qe,1,0,"tr",21),l.Sb(),l.Sb()),2&t){const t=l.fc();l.Bb(1),l.lc("dataSource",t.dataSource),l.Bb(25),l.lc("matHeaderRowDef",t.displayedColumns),l.Bb(1),l.lc("matRowDefColumns",t.displayedColumns)}}function Pe(t,e){1&t&&l.Ob(0,"app-simple-message",31)}function Qe(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",35),l.bc("click",function(){l.xc(t);const e=l.fc().item,i=l.fc();return i.openNewForm(i.typeForm.DIARY,!1,e)}),l.Tb(1,"mat-icon"),l.Hc(2,"remove_red_eye"),l.Sb(),l.Hc(3," Visualizar di\xe1rio "),l.Sb()}}function Le(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",35),l.bc("click",function(){l.xc(t);const e=l.fc().item,i=l.fc();return i.openNewForm(i.typeForm.DIARY,!0,e)}),l.Tb(1,"mat-icon"),l.Hc(2,"edit"),l.Sb(),l.Hc(3," Editar di\xe1rio "),l.Sb()}}function $e(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",35),l.bc("click",function(){l.xc(t);const e=l.fc().item;return l.fc().confirmRemove(e)}),l.Tb(1,"mat-icon"),l.Hc(2,"delete_outline"),l.Sb(),l.Hc(3," Remover di\xe1rio "),l.Sb()}}function je(t,e){1&t&&l.Ob(0,"mat-divider")}function Ue(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",35),l.bc("click",function(){l.xc(t);const e=l.fc(2);return e.openNewForm(e.typeForm.DIARY,!0)}),l.Tb(1,"mat-icon"),l.Hc(2,"add_circle_outline"),l.Sb(),l.Hc(3," Novo di\xe1rio "),l.Sb()}}function Je(t,e){1&t&&(l.Tb(0,"button",36),l.Hc(1," Nenhuma a\xe7\xe3o dispon\xedvel devido ao atual status da demanda :/ "),l.Sb())}function Ye(t,e){if(1&t&&(l.Fc(0,Qe,4,0,"button",32),l.Fc(1,Le,4,0,"button",32),l.Fc(2,$e,4,0,"button",32),l.Fc(3,je,1,0,"mat-divider",33),l.Fc(4,Ue,4,0,"button",32),l.Fc(5,Je,2,0,"button",34)),2&t){const t=e.item,i=l.fc();l.lc("ngIf",t),l.Bb(1),l.lc("ngIf",i.showEditButton(t)),l.Bb(1),l.lc("ngIf",t),l.Bb(1),l.lc("ngIf",t),l.Bb(1),l.lc("ngIf",i.showNewButton()),l.Bb(1),l.lc("ngIf",!t&&!i.showNewButton()&&!i.showEditButton(t))}}let ze=(()=>{class t{constructor(t,e,i,n,o,c,a){this.utilsService=t,this.spbFormsService=e,this.messageService=i,this.loadingService=n,this.errorHandlerService=o,this.diaryService=c,this.demandsService=a,this.diaries=[],this.displayedColumns=["actions","icon","rowNumber","dtOcorrencia","classeServico.descricao","descricao","horas","etcm"],this.contextMenuPosition=new k.a,this.unsubscribeNotifier=new A.a}ngOnInit(){this.typeForm=me,this.dataSource=new _.k(this.diaries),this.listenOnSaveSpbForms()}ngOnDestroy(){this.unsubscribeNotifier.next(),this.unsubscribeNotifier.complete()}updateDemand(){this.loadingService.show(),this.demandsService.getEtcmEtccIncurrido(this.demand.demanda_id).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{this.demand.etcc=t.etcc,this.demand.etcm=t.etcm,this.demand.incurridoTotal=t.incurridoTotal},()=>this.messageService.snackMessage("Erro ao atualizar valores da story.","error")).add(()=>this.loadingService.hide())}listenOnSaveSpbForms(){this.spbFormsService.onSave.pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{if(t.type===me.DIARY&&t.item.demanda.demanda_id===this.demand.demanda_id){if(this.updateDemand(),t.action===c.a.CREATED)this.diaries||(this.diaries=[]),this.diaries.push(t.item);else if(t.action===c.a.UPDATED){const e=this.diaries.findIndex(e=>e.diario_bordo_id===t.item.diario_bordo_id);this.utilsService.setValueAtItem(this.diaries[e],t.item)}this.dataSource=new _.k(this.diaries)}})}onContextMenu(t,e){this.contextMenuPosition=this.utilsService.openContextMenu(t,this.contextMenu,{item:e})}openNewForm(t,e,i){this.spbFormsService.openForm(t,i,e,{demand:this.demand,sprint:this.sprint})}confirmRemove(t){this.messageService.swalMessage("Deseja realmente excluir o lan\xe7amento no di\xe1rio?","Uma vez feito isso n\xe3o ser\xe1 poss\xedvel desfazer.","question").then(e=>{e.value&&this.remove(t)})}remove(t){this.loadingService.show(),this.diaryService.delete(t.diario_bordo_id).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(()=>{this.updateDemand(),this.messageService.snackMessage("Di\xe1rio removido com sucesso!","success");const e=this.diaries.findIndex(e=>e.diario_bordo_id===t.diario_bordo_id);this.diaries.splice(e,1),this.dataSource=new _.k(this.diaries),this.diaryService.diaryChanges.next()},t=>this.errorHandlerService.handleError(t,"Erro ao excluir lan\xe7amento no di\xe1rio!")).add(()=>this.loadingService.hide())}showEditButton(t){return t&&this.demand.statusDemanda.status_demanda_id!==Se.a.BACKLOG&&this.demand.statusDemanda.status_demanda_id!==Se.a.READY_TO_START&&this.demand.statusDemanda.status_demanda_id!==Se.a.CANCELLED&&this.demand.statusDemanda.status_demanda_id!==Se.a.DONE&&this.demand.statusDemanda.status_demanda_id!==Se.a.DELIVERED}showNewButton(){return this.demand.statusDemanda.status_demanda_id!==Se.a.BACKLOG&&this.demand.statusDemanda.status_demanda_id!==Se.a.READY_TO_START&&this.demand.statusDemanda.status_demanda_id!==Se.a.CANCELLED&&this.demand.statusDemanda.status_demanda_id!==Se.a.DONE&&this.demand.statusDemanda.status_demanda_id!==Se.a.DELIVERED}}return t.\u0275fac=function(e){return new(e||t)(l.Nb($.a),l.Nb(be),l.Nb(L.a),l.Nb(p.a),l.Nb(ve.a),l.Nb(j.a),l.Nb(Q.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-list-diary"]],viewQuery:function(t,e){if(1&t&&l.Lc(q.e,!0),2&t){let t;l.tc(t=l.cc())&&(e.contextMenu=t.first)}},inputs:{diaries:"diaries",demand:"demand",sprint:"sprint"},decls:9,vars:7,consts:[[3,"contextmenu"],["class","wrapper-table-scrolling without-max-height",4,"ngIf"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["message","Nenhum di\xe1rio encontrado. Clique com o bot\xe3o direito para criar um novo :)",4,"ngIf"],["contextMenu","matMenu"],["matMenuContent",""],[1,"wrapper-table-scrolling","without-max-height"],["mat-table","",3,"dataSource"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","icon"],["mat-cell","","class","auto-width-column",4,"matCellDef"],["matColumnDef","rowNumber"],["matColumnDef","dtOcorrencia"],["matColumnDef","classeServico.descricao"],["mat-cell","","class","font-weight-bold",4,"matCellDef"],["matColumnDef","descricao"],["matColumnDef","horas"],["matColumnDef","etcm"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","element-row",3,"contextmenu",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-cell","",1,"auto-width-column"],["src","assets/icon/diary.png","alt","Di\xe1rio","matTooltip","Di\xe1rio",1,"icon"],["mat-cell","",1,"font-weight-bold"],[3,"matTooltip"],["mat-header-row",""],["mat-row","",1,"element-row",3,"contextmenu"],["message","Nenhum di\xe1rio encontrado. Clique com o bot\xe3o direito para criar um novo :)"],["mat-menu-item","",3,"click",4,"ngIf"],[4,"ngIf"],["class","button-break-line","disabled","","mat-menu-item","",4,"ngIf"],["mat-menu-item","",3,"click"],["disabled","","mat-menu-item","",1,"button-break-line"]],template:function(t,e){if(1&t&&(l.Tb(0,"div",0),l.bc("contextmenu",function(t){return e.onContextMenu(t)}),l.Tb(1,"h5"),l.Hc(2,"Di\xe1rios"),l.Sb(),l.Fc(3,Ae,28,3,"div",1),l.Ob(4,"div",2),l.Fc(5,Pe,1,0,"app-simple-message",3),l.Sb(),l.Tb(6,"mat-menu",null,4),l.Fc(8,Ye,6,6,"ng-template",5),l.Sb()),2&t){const t=l.uc(7);l.Bb(3),l.lc("ngIf",(null==e.dataSource?null:e.dataSource.data.length)>0),l.Bb(1),l.Cc("left",e.contextMenuPosition.x)("top",e.contextMenuPosition.y),l.lc("matMenuTriggerFor",t),l.Bb(1),l.lc("ngIf",0==(null==e.dataSource?null:e.dataSource.data.length))}},directives:[o.l,q.e,q.a,q.b,_.j,_.c,_.e,_.b,_.g,_.i,_.d,_.a,X.b,Z.a,et.a,_.f,_.h,I.a,q.c,at.a],pipes:[o.e,ge.a,st.a],styles:["table[_ngcontent-%COMP%]{background:rgba(0,0,0,.0196078431372549)}h5[_ngcontent-%COMP%]{font-size:12px;margin:0;font-weight:400;opacity:.75}"]}),t})();var Ve=i("kRIO"),Ke=i("LGGl");function We(t,e){1&t&&l.Ob(0,"th",26)}function Ge(t,e){if(1&t){const t=l.Ub();l.Tb(0,"td",27),l.Tb(1,"button",28),l.bc("click",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Tb(2,"mat-icon"),l.Hc(3,"more_vert"),l.Sb(),l.Sb(),l.Sb()}}function Xe(t,e){1&t&&l.Ob(0,"th",26)}function Ze(t,e){1&t&&(l.Tb(0,"td",29),l.Ob(1,"img",30),l.Sb())}function ti(t,e){1&t&&(l.Tb(0,"th",26),l.Hc(1,"#"),l.Sb())}function ei(t,e){if(1&t&&(l.Tb(0,"td",27),l.Hc(1),l.Sb()),2&t){const t=e.index;l.Bb(1),l.Jc(" ",t+1," ")}}function ii(t,e){1&t&&(l.Tb(0,"th",26),l.Hc(1,"Status"),l.Sb())}function ni(t,e){if(1&t&&(l.Tb(0,"td",27),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.statusDefeito.descricao)}}function oi(t,e){1&t&&(l.Tb(0,"th",26),l.Hc(1,"T\xedtulo"),l.Sb())}function ci(t,e){if(1&t&&(l.Tb(0,"td",31),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.titulo)}}function ai(t,e){1&t&&(l.Tb(0,"th",26),l.Hc(1,"Tipo"),l.Sb())}function si(t,e){if(1&t&&(l.Tb(0,"td",27),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.tipoDefeito.descricao)}}function ri(t,e){1&t&&(l.Tb(0,"th",26),l.Hc(1,"Respons\xe1vel"),l.Sb())}function li(t,e){if(1&t&&(l.Tb(0,"td",27),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.responsavel.nome)}}function di(t,e){1&t&&(l.Tb(0,"th",26),l.Hc(1,"Horas"),l.Sb())}function bi(t,e){if(1&t&&(l.Tb(0,"td",27),l.Hc(1),l.gc(2,"decimalNumber"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(l.hc(2,1,t.horas))}}function mi(t,e){1&t&&(l.Tb(0,"th",26),l.Hc(1,"Abertura"),l.Sb())}function ui(t,e){if(1&t&&(l.Tb(0,"td",27),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtAbertura,"dd/MM/yy")," ")}}function fi(t,e){1&t&&(l.Tb(0,"th",26),l.Hc(1,"In\xedcio"),l.Sb())}function pi(t,e){if(1&t&&(l.Tb(0,"td",27),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtInicio,"dd/MM/yy")," ")}}function hi(t,e){1&t&&(l.Tb(0,"th",26),l.Hc(1,"Fim"),l.Sb())}function Si(t,e){if(1&t&&(l.Tb(0,"td",27),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtFim,"dd/MM/yy")," ")}}function vi(t,e){1&t&&(l.Tb(0,"th",26),l.Hc(1,"Procedente"),l.Sb())}function gi(t,e){if(1&t&&(l.Tb(0,"td",27),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",t.procedente?"SIM":"N\xc3O"," ")}}function Fi(t,e){1&t&&l.Ob(0,"tr",32)}function Ti(t,e){if(1&t){const t=l.Ub();l.Tb(0,"tr",33),l.bc("contextmenu",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Sb()}}function wi(t,e){if(1&t&&(l.Tb(0,"div",6),l.Tb(1,"table",7),l.Rb(2,8),l.Fc(3,We,1,0,"th",9),l.Fc(4,Ge,4,0,"td",10),l.Qb(),l.Rb(5,11),l.Fc(6,Xe,1,0,"th",9),l.Fc(7,Ze,2,0,"td",12),l.Qb(),l.Rb(8,13),l.Fc(9,ti,2,0,"th",9),l.Fc(10,ei,2,1,"td",10),l.Qb(),l.Rb(11,14),l.Fc(12,ii,2,0,"th",9),l.Fc(13,ni,2,1,"td",10),l.Qb(),l.Rb(14,15),l.Fc(15,oi,2,0,"th",9),l.Fc(16,ci,2,1,"td",16),l.Qb(),l.Rb(17,17),l.Fc(18,ai,2,0,"th",9),l.Fc(19,si,2,1,"td",10),l.Qb(),l.Rb(20,18),l.Fc(21,ri,2,0,"th",9),l.Fc(22,li,2,1,"td",10),l.Qb(),l.Rb(23,19),l.Fc(24,di,2,0,"th",9),l.Fc(25,bi,3,3,"td",10),l.Qb(),l.Rb(26,20),l.Fc(27,mi,2,0,"th",9),l.Fc(28,ui,3,4,"td",10),l.Qb(),l.Rb(29,21),l.Fc(30,fi,2,0,"th",9),l.Fc(31,pi,3,4,"td",10),l.Qb(),l.Rb(32,22),l.Fc(33,hi,2,0,"th",9),l.Fc(34,Si,3,4,"td",10),l.Qb(),l.Rb(35,23),l.Fc(36,vi,2,0,"th",9),l.Fc(37,gi,2,1,"td",10),l.Qb(),l.Fc(38,Fi,1,0,"tr",24),l.Fc(39,Ti,1,0,"tr",25),l.Sb(),l.Sb()),2&t){const t=l.fc();l.Bb(1),l.lc("dataSource",t.dataSource),l.Bb(37),l.lc("matHeaderRowDef",t.displayedColumns),l.Bb(1),l.lc("matRowDefColumns",t.displayedColumns)}}function Ci(t,e){1&t&&l.Ob(0,"app-simple-message",34)}function Di(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",38),l.bc("click",function(){l.xc(t);const e=l.fc().item,i=l.fc();return i.openNewForm(i.typeForm.DEFECT,!1,e)}),l.Tb(1,"mat-icon"),l.Hc(2,"remove_red_eye"),l.Sb(),l.Hc(3," Visualizar defeito "),l.Sb()}}function xi(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",38),l.bc("click",function(){l.xc(t);const e=l.fc().item,i=l.fc();return i.openNewForm(i.typeForm.DEFECT,!0,e)}),l.Tb(1,"mat-icon"),l.Hc(2,"edit"),l.Sb(),l.Hc(3," Editar defeito "),l.Sb()}}function Ii(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",38),l.bc("click",function(){l.xc(t);const e=l.fc().item;return l.fc().confirmRemove(e)}),l.Tb(1,"mat-icon"),l.Hc(2,"delete_outline"),l.Sb(),l.Hc(3," Remover defeito "),l.Sb()}}function Ei(t,e){1&t&&l.Ob(0,"mat-divider")}function Bi(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",38),l.bc("click",function(){l.xc(t);const e=l.fc(2);return e.openNewForm(e.typeForm.DEFECT,!0)}),l.Tb(1,"mat-icon"),l.Hc(2,"add_circle_outline"),l.Sb(),l.Hc(3," Novo defeito "),l.Sb()}}function Oi(t,e){1&t&&(l.Tb(0,"button",39),l.Hc(1," Nenhuma a\xe7\xe3o dispon\xedvel devido ao atual status da demanda :/ "),l.Sb())}function Ri(t,e){if(1&t&&(l.Fc(0,Di,4,0,"button",35),l.Fc(1,xi,4,0,"button",35),l.Fc(2,Ii,4,0,"button",35),l.Fc(3,Ei,1,0,"mat-divider",36),l.Fc(4,Bi,4,0,"button",35),l.Fc(5,Oi,2,0,"button",37)),2&t){const t=e.item,i=l.fc();l.lc("ngIf",t),l.Bb(1),l.lc("ngIf",i.showEditButton(t)),l.Bb(1),l.lc("ngIf",t),l.Bb(1),l.lc("ngIf",t),l.Bb(1),l.lc("ngIf",i.showNewButton()),l.Bb(1),l.lc("ngIf",!t&&!i.showNewButton()&&!i.showEditButton(t))}}let Ni=(()=>{class t{constructor(t,e,i,n,o,c,a){this.spbFormsService=t,this.utilsService=e,this.messageService=i,this.loadingService=n,this.errorHandlerService=o,this.defectsService=c,this.typeDefectsService=a,this.defects=[],this.displayedColumns=["actions","icon","rowNumber","statusDefeito.descricao","titulo","tipoDefeito.descricao","responsavel.nome","horas","dtAbertura","dtInicio","dtFim","procedente"],this.contextMenuPosition=new k.a,this.unsubscribeNotifier=new A.a}ngOnInit(){this.typeForm=me,this.dataSource=new _.k(this.defects),this.listenOnSaveSpbForms()}ngOnDestroy(){this.unsubscribeNotifier.next(),this.unsubscribeNotifier.complete()}listenOnSaveSpbForms(){this.spbFormsService.onSave.pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{if(t.type===me.DEFECT&&t.item.demanda.demanda_id===this.demand.demanda_id){const e=t.item.tipoDefeito,i=this.typeDefectsService.getDescriptionOfType(e);if(t.item.tipoDefeito={defeito_id:e,descricao:i},t.action===c.a.CREATED)this.defects||(this.defects=[]),this.defects.push(t.item);else if(t.action===c.a.UPDATED){const e=this.defects.findIndex(e=>e.defeito_id===t.item.defeito_id);this.utilsService.setValueAtItem(this.defects[e],t.item)}this.dataSource=new _.k(this.defects)}})}onContextMenu(t,e){this.contextMenuPosition=this.utilsService.openContextMenu(t,this.contextMenu,{item:e})}openNewForm(t,e,i){this.spbFormsService.openForm(t,i,e,{demand:this.demand,sprint:this.sprint})}confirmRemove(t){this.messageService.swalMessage("Deseja realmente excluir o defeito?","Uma vez feito isso n\xe3o ser\xe1 poss\xedvel desfazer.","question").then(e=>{e.value&&this.remove(t)})}remove(t){this.loadingService.show(),this.defectsService.delete(t.defeito_id).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(()=>{this.messageService.snackMessage("Defeito removido com sucesso!","success");const e=this.defects.findIndex(e=>e.defeito_id===t.defeito_id);this.defects.splice(e,1),this.dataSource=new _.k(this.defects)},t=>this.errorHandlerService.handleError(t,"Erro ao excluir defeito!")).add(()=>this.loadingService.hide())}showEditButton(t){return t&&this.demand.statusDemanda.status_demanda_id!==Se.a.DONE&&this.demand.statusDemanda.status_demanda_id!==Se.a.DELIVERED||t&&"E"===t.tipoDefeito}showNewButton(){return this.demand.statusDemanda.status_demanda_id!==Se.a.CANCELLED}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(be),l.Nb($.a),l.Nb(L.a),l.Nb(p.a),l.Nb(ve.a),l.Nb(Ve.a),l.Nb(Ke.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-list-defects"]],viewQuery:function(t,e){if(1&t&&l.Lc(q.e,!0),2&t){let t;l.tc(t=l.cc())&&(e.contextMenu=t.first)}},inputs:{defects:"defects",demand:"demand",sprint:"sprint"},decls:9,vars:7,consts:[[3,"contextmenu"],["class","wrapper-table-scrolling without-max-height",4,"ngIf"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["message","Nenhum defeito encontrado. Clique com o bot\xe3o direito para criar um novo :)",4,"ngIf"],["contextMenu","matMenu"],["matMenuContent",""],[1,"wrapper-table-scrolling","without-max-height"],["mat-table","",3,"dataSource"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","icon"],["mat-cell","","class","auto-width-column",4,"matCellDef"],["matColumnDef","rowNumber"],["matColumnDef","statusDefeito.descricao"],["matColumnDef","titulo"],["mat-cell","","class","font-weight-bold",4,"matCellDef"],["matColumnDef","tipoDefeito.descricao"],["matColumnDef","responsavel.nome"],["matColumnDef","horas"],["matColumnDef","dtAbertura"],["matColumnDef","dtInicio"],["matColumnDef","dtFim"],["matColumnDef","procedente"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","element-row",3,"contextmenu",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-cell","",1,"auto-width-column"],["src","assets/icon/defect.png","alt","Defeito","matTooltip","Defeito",1,"icon"],["mat-cell","",1,"font-weight-bold"],["mat-header-row",""],["mat-row","",1,"element-row",3,"contextmenu"],["message","Nenhum defeito encontrado. Clique com o bot\xe3o direito para criar um novo :)"],["mat-menu-item","",3,"click",4,"ngIf"],[4,"ngIf"],["class","button-break-line","disabled","","mat-menu-item","",4,"ngIf"],["mat-menu-item","",3,"click"],["disabled","","mat-menu-item","",1,"button-break-line"]],template:function(t,e){if(1&t&&(l.Tb(0,"div",0),l.bc("contextmenu",function(t){return e.onContextMenu(t)}),l.Tb(1,"h5"),l.Hc(2,"Defeitos"),l.Sb(),l.Fc(3,wi,40,3,"div",1),l.Ob(4,"div",2),l.Fc(5,Ci,1,0,"app-simple-message",3),l.Sb(),l.Tb(6,"mat-menu",null,4),l.Fc(8,Ri,6,6,"ng-template",5),l.Sb()),2&t){const t=l.uc(7);l.Bb(3),l.lc("ngIf",(null==e.dataSource?null:e.dataSource.data.length)>0),l.Bb(1),l.Cc("left",e.contextMenuPosition.x)("top",e.contextMenuPosition.y),l.lc("matMenuTriggerFor",t),l.Bb(1),l.lc("ngIf",0==(null==e.dataSource?null:e.dataSource.data.length))}},directives:[o.l,q.e,q.a,q.b,_.j,_.c,_.e,_.b,_.g,_.i,_.d,_.a,X.b,Z.a,et.a,_.f,_.h,I.a,q.c,at.a],pipes:[st.a,o.e],styles:["table[_ngcontent-%COMP%]{background:rgba(0,0,0,.0196078431372549)}h5[_ngcontent-%COMP%]{font-size:12px;margin:0;font-weight:400;opacity:.75}"]}),t})();var Mi=i("pxkN");function ki(t,e){1&t&&l.Ob(0,"th",22)}function Hi(t,e){if(1&t){const t=l.Ub();l.Tb(0,"td",23),l.Tb(1,"button",24),l.bc("click",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Tb(2,"mat-icon"),l.Hc(3,"more_vert"),l.Sb(),l.Sb(),l.Sb()}}function yi(t,e){1&t&&l.Ob(0,"th",22)}function _i(t,e){1&t&&(l.Tb(0,"td",25),l.Ob(1,"img",26),l.Sb())}function qi(t,e){1&t&&(l.Tb(0,"th",22),l.Hc(1,"#"),l.Sb())}function Ai(t,e){if(1&t&&(l.Tb(0,"td",23),l.Hc(1),l.Sb()),2&t){const t=e.index;l.Bb(1),l.Jc(" ",t+1," ")}}function Pi(t,e){1&t&&(l.Tb(0,"th",22),l.Hc(1,"Abertura"),l.Sb())}function Qi(t,e){if(1&t&&(l.Tb(0,"td",23),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtAbertura,"dd/MM/yy")," ")}}function Li(t,e){1&t&&(l.Tb(0,"th",22),l.Hc(1,"T\xedtulo"),l.Sb())}function $i(t,e){if(1&t&&(l.Tb(0,"td",27),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.titulo)}}function ji(t,e){1&t&&(l.Tb(0,"th",22),l.Hc(1,"Horas"),l.Sb())}function Ui(t,e){if(1&t&&(l.Tb(0,"td",23),l.Hc(1),l.gc(2,"decimalNumber"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.hc(2,1,t.horasBloqueio)," ")}}function Ji(t,e){1&t&&(l.Tb(0,"th",22),l.Hc(1,"In\xedcio"),l.Sb())}function Yi(t,e){if(1&t&&(l.Tb(0,"td",23),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtInicio,"dd/MM/yy")," ")}}function zi(t,e){1&t&&(l.Tb(0,"th",22),l.Hc(1,"Fim"),l.Sb())}function Vi(t,e){if(1&t&&(l.Tb(0,"td",23),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtFim,"dd/MM/yy")," ")}}function Ki(t,e){1&t&&l.Ob(0,"tr",28)}function Wi(t,e){if(1&t){const t=l.Ub();l.Tb(0,"tr",29),l.bc("contextmenu",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Sb()}}function Gi(t,e){if(1&t&&(l.Tb(0,"div",6),l.Tb(1,"table",7),l.Rb(2,8),l.Fc(3,ki,1,0,"th",9),l.Fc(4,Hi,4,0,"td",10),l.Qb(),l.Rb(5,11),l.Fc(6,yi,1,0,"th",9),l.Fc(7,_i,2,0,"td",12),l.Qb(),l.Rb(8,13),l.Fc(9,qi,2,0,"th",9),l.Fc(10,Ai,2,1,"td",10),l.Qb(),l.Rb(11,14),l.Fc(12,Pi,2,0,"th",9),l.Fc(13,Qi,3,4,"td",10),l.Qb(),l.Rb(14,15),l.Fc(15,Li,2,0,"th",9),l.Fc(16,$i,2,1,"td",16),l.Qb(),l.Rb(17,17),l.Fc(18,ji,2,0,"th",9),l.Fc(19,Ui,3,3,"td",10),l.Qb(),l.Rb(20,18),l.Fc(21,Ji,2,0,"th",9),l.Fc(22,Yi,3,4,"td",10),l.Qb(),l.Rb(23,19),l.Fc(24,zi,2,0,"th",9),l.Fc(25,Vi,3,4,"td",10),l.Qb(),l.Fc(26,Ki,1,0,"tr",20),l.Fc(27,Wi,1,0,"tr",21),l.Sb(),l.Sb()),2&t){const t=l.fc();l.Bb(1),l.lc("dataSource",t.dataSource),l.Bb(25),l.lc("matHeaderRowDef",t.displayedColumns),l.Bb(1),l.lc("matRowDefColumns",t.displayedColumns)}}function Xi(t,e){1&t&&l.Ob(0,"app-simple-message",30)}function Zi(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",34),l.bc("click",function(){l.xc(t);const e=l.fc().item,i=l.fc();return i.openNewForm(i.typeForm.BLOCK,!1,e)}),l.Tb(1,"mat-icon"),l.Hc(2,"remove_red_eye"),l.Sb(),l.Hc(3," Visualizar bloqueio "),l.Sb()}}function tn(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",34),l.bc("click",function(){l.xc(t);const e=l.fc().item,i=l.fc();return i.openNewForm(i.typeForm.BLOCK,!0,e)}),l.Tb(1,"mat-icon"),l.Hc(2,"edit"),l.Sb(),l.Hc(3," Editar bloqueio "),l.Sb()}}function en(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",34),l.bc("click",function(){l.xc(t);const e=l.fc().item;return l.fc().confirmRemove(e)}),l.Tb(1,"mat-icon"),l.Hc(2,"delete_outline"),l.Sb(),l.Hc(3," Remover bloqueio "),l.Sb()}}function nn(t,e){1&t&&l.Ob(0,"mat-divider")}function on(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",34),l.bc("click",function(){l.xc(t);const e=l.fc(2);return e.openNewForm(e.typeForm.BLOCK,!0)}),l.Tb(1,"mat-icon"),l.Hc(2,"add_circle_outline"),l.Sb(),l.Hc(3," Novo bloqueio "),l.Sb()}}function cn(t,e){1&t&&(l.Tb(0,"button",35),l.Hc(1," Nenhuma a\xe7\xe3o dispon\xedvel devido ao atual status da demanda :/ "),l.Sb())}function an(t,e){if(1&t&&(l.Fc(0,Zi,4,0,"button",31),l.Fc(1,tn,4,0,"button",31),l.Fc(2,en,4,0,"button",31),l.Fc(3,nn,1,0,"mat-divider",32),l.Fc(4,on,4,0,"button",31),l.Fc(5,cn,2,0,"button",33)),2&t){const t=e.item,i=l.fc();l.lc("ngIf",t),l.Bb(1),l.lc("ngIf",i.showEditButton(t)),l.Bb(1),l.lc("ngIf",t),l.Bb(1),l.lc("ngIf",t),l.Bb(1),l.lc("ngIf",i.showNewButton()),l.Bb(1),l.lc("ngIf",!i.showNewButton()&&!i.showEditButton(t)&&!t)}}let sn=(()=>{class t{constructor(t,e,i,n,o,c){this.spbFormsService=t,this.utilsService=e,this.messageService=i,this.loadingService=n,this.errorHandlerService=o,this.blocksService=c,this.blocks=[],this.displayedColumns=["actions","icon","rowNumber","dtAbertura","titulo","horasBloqueio","dtInicio","dtFim"],this.contextMenuPosition=new k.a,this.unsubscribeNotifier=new A.a}ngOnInit(){this.typeForm=me,this.dataSource=new _.k(this.blocks),this.listenOnSaveSpbForms()}ngOnDestroy(){this.unsubscribeNotifier.next(),this.unsubscribeNotifier.complete()}listenOnSaveSpbForms(){this.spbFormsService.onSave.pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{if(t.type===me.BLOCK&&t.item.demanda.demanda_id===this.demand.demanda_id){if(t.action===c.a.CREATED)this.blocks||(this.blocks=[]),this.blocks.push(t.item);else if(t.action===c.a.UPDATED){const e=this.blocks.findIndex(e=>e.bloqueio_id===t.item.bloqueio_id);this.utilsService.setValueAtItem(this.blocks[e],t.item)}this.dataSource=new _.k(this.blocks)}})}onContextMenu(t,e){this.contextMenuPosition=this.utilsService.openContextMenu(t,this.contextMenu,{item:e})}openNewForm(t,e,i){this.spbFormsService.openForm(t,i,e,{demand:this.demand,sprint:this.sprint})}confirmRemove(t){this.messageService.swalMessage("Deseja realmente excluir o bloqueio?","Uma vez feito isso n\xe3o ser\xe1 poss\xedvel desfazer.","question").then(e=>{e.value&&this.remove(t)})}remove(t){this.loadingService.show(),this.blocksService.delete(t.bloqueio_id).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(()=>{this.messageService.snackMessage("Bloqueio removido com sucesso!","success");const e=this.blocks.findIndex(e=>e.bloqueio_id===t.bloqueio_id);this.blocks.splice(e,1),this.dataSource=new _.k(this.blocks)},t=>this.errorHandlerService.handleError(t,"Erro ao excluir bloqueio!")).add(()=>this.loadingService.hide())}showNewButton(){return this.demand.statusDemanda.status_demanda_id!==Se.a.CANCELLED&&this.demand.statusDemanda.status_demanda_id!==Se.a.DONE&&this.demand.statusDemanda.status_demanda_id!==Se.a.DELIVERED}showEditButton(t){return t&&this.demand.statusDemanda.status_demanda_id!==Se.a.DONE&&this.demand.statusDemanda.status_demanda_id!==Se.a.DELIVERED}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(be),l.Nb($.a),l.Nb(L.a),l.Nb(p.a),l.Nb(ve.a),l.Nb(Mi.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-list-blocks"]],viewQuery:function(t,e){if(1&t&&l.Lc(q.e,!0),2&t){let t;l.tc(t=l.cc())&&(e.contextMenu=t.first)}},inputs:{blocks:"blocks",demand:"demand",sprint:"sprint"},decls:9,vars:7,consts:[[3,"contextmenu"],["class","wrapper-table-scrolling without-max-height",4,"ngIf"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["message","Nenhum bloqueio encontrado. Clique com o bot\xe3o direito para criar um novo :)",4,"ngIf"],["contextMenu","matMenu"],["matMenuContent",""],[1,"wrapper-table-scrolling","without-max-height"],["mat-table","",3,"dataSource"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","icon"],["mat-cell","","class","auto-width-column",4,"matCellDef"],["matColumnDef","rowNumber"],["matColumnDef","dtAbertura"],["matColumnDef","titulo"],["mat-cell","","class","font-weight-bold",4,"matCellDef"],["matColumnDef","horasBloqueio"],["matColumnDef","dtInicio"],["matColumnDef","dtFim"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","element-row",3,"contextmenu",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-cell","",1,"auto-width-column"],["src","assets/icon/blocks.png","alt","Bloqueio","matTooltip","Bloqueio",1,"icon"],["mat-cell","",1,"font-weight-bold"],["mat-header-row",""],["mat-row","",1,"element-row",3,"contextmenu"],["message","Nenhum bloqueio encontrado. Clique com o bot\xe3o direito para criar um novo :)"],["mat-menu-item","",3,"click",4,"ngIf"],[4,"ngIf"],["class","button-break-line","disabled","","mat-menu-item","",4,"ngIf"],["mat-menu-item","",3,"click"],["disabled","","mat-menu-item","",1,"button-break-line"]],template:function(t,e){if(1&t&&(l.Tb(0,"div",0),l.bc("contextmenu",function(t){return e.onContextMenu(t)}),l.Tb(1,"h5"),l.Hc(2,"Bloqueios"),l.Sb(),l.Fc(3,Gi,28,3,"div",1),l.Ob(4,"div",2),l.Fc(5,Xi,1,0,"app-simple-message",3),l.Sb(),l.Tb(6,"mat-menu",null,4),l.Fc(8,an,6,6,"ng-template",5),l.Sb()),2&t){const t=l.uc(7);l.Bb(3),l.lc("ngIf",(null==e.dataSource?null:e.dataSource.data.length)>0),l.Bb(1),l.Cc("left",e.contextMenuPosition.x)("top",e.contextMenuPosition.y),l.lc("matMenuTriggerFor",t),l.Bb(1),l.lc("ngIf",0==(null==e.dataSource?null:e.dataSource.data.length))}},directives:[o.l,q.e,q.a,q.b,_.j,_.c,_.e,_.b,_.g,_.i,_.d,_.a,X.b,Z.a,et.a,_.f,_.h,I.a,q.c,at.a],pipes:[o.e,st.a],styles:["table[_ngcontent-%COMP%]{background:rgba(0,0,0,.0196078431372549)}h5[_ngcontent-%COMP%]{font-size:12px;margin:0;font-weight:400;opacity:.75}"]}),t})(),rn=(()=>{class t{constructor(){this.diaries=[],this.defects=[],this.blocks=[]}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Hb({type:t,selectors:[["app-spb-list-diary"]],inputs:{diaries:"diaries",defects:"defects",blocks:"blocks",demand:"demand",sprint:"sprint"},decls:6,vars:9,consts:[[1,"block"],[3,"diaries","demand","sprint"],[3,"defects","demand","sprint"],[3,"blocks","demand","sprint"]],template:function(t,e){1&t&&(l.Tb(0,"div",0),l.Ob(1,"app-list-diary",1),l.Sb(),l.Tb(2,"div",0),l.Ob(3,"app-list-defects",2),l.Sb(),l.Tb(4,"div",0),l.Ob(5,"app-list-blocks",3),l.Sb()),2&t&&(l.Bb(1),l.lc("diaries",e.diaries)("demand",e.demand)("sprint",e.sprint),l.Bb(2),l.lc("defects",e.defects)("demand",e.demand)("sprint",e.sprint),l.Bb(2),l.lc("blocks",e.blocks)("demand",e.demand)("sprint",e.sprint))},directives:[ze,Ni,sn],styles:[".block[_ngcontent-%COMP%]:not(:last-child){padding:4px 0;margin:2px 0;border-bottom:1px solid #b5b5b5}"]}),t})();function ln(t,e){1&t&&l.Ob(0,"th",35)}function dn(t,e){if(1&t){const t=l.Ub();l.Tb(0,"td",36),l.Tb(1,"button",37),l.bc("click",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Tb(2,"mat-icon"),l.Hc(3,"more_vert"),l.Sb(),l.Sb(),l.Sb()}}function bn(t,e){1&t&&l.Ob(0,"th",35)}function mn(t,e){1&t&&(l.Tb(0,"td",38),l.Ob(1,"img",39),l.Sb())}function un(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"#"),l.Sb())}function fn(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.Sb()),2&t){const t=e.dataIndex;l.Bb(1),l.Jc(" ",t+1," ")}}function pn(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"Risco"),l.Sb())}function hn(t,e){if(1&t&&(l.Tb(0,"td",36),l.Tb(1,"div",40),l.Tb(2,"mat-icon",41),l.Hc(3," fiber_manual_record "),l.Sb(),l.Sb(),l.Sb()),2&t){const t=e.$implicit,i=l.fc(2);l.Bb(2),l.Cc("color",i.risksTypesService.getColorOfRisk(t.nivelRisco)),l.lc("matTooltip",i.risksTypesService.getDescriptionOfRisk(t.nivelRisco))}}function Sn(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"Status"),l.Sb())}function vn(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",t.statusDemanda.descricao," ")}}function gn(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"N\xfamero"),l.Sb())}function Fn(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.storyNumber)}}function Tn(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"T\xedtulo"),l.Sb())}function wn(t,e){if(1&t&&(l.Tb(0,"td",42),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.titulo)}}function Cn(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"Respons\xe1vel"),l.Sb())}function Dn(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.desenvolvedor.nome)}}function xn(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"Tecnologia"),l.Sb())}function In(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.tecnologia.descricao)}}function En(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"Estimativa"),l.Sb())}function Bn(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.gc(2,"decimalNumber"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.hc(2,1,t.horasEstimadas)," ")}}function On(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"Incurrido"),l.Sb())}function Rn(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.gc(2,"decimalNumber"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.hc(2,1,t.incurridoTotal)," ")}}function Nn(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"ETCc"),l.Sb())}function Mn(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.gc(2,"decimalNumber"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(l.hc(2,1,t.etcc))}}function kn(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"ETCm"),l.Sb())}function Hn(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.gc(2,"decimalNumber"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(l.hc(2,1,t.etcm))}}function yn(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"Recebimento"),l.Sb())}function _n(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtRecebimento,"dd/MM/yy")," ")}}function qn(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"In\xedcio plan."),l.Sb())}function An(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtEntrada,"dd/MM/yy")," ")}}function Pn(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"Fim plan."),l.Sb())}function Qn(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtEntregaAcordada,"dd/MM/yy")," ")}}function Ln(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"In\xedcio real"),l.Sb())}function $n(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtInicioReal,"dd/MM/yy")," ")}}function jn(t,e){1&t&&(l.Tb(0,"th",35),l.Hc(1,"Entrega real"),l.Sb())}function Un(t,e){if(1&t&&(l.Tb(0,"td",36),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtFimReal,"dd/MM/yy")," ")}}function Jn(t,e){if(1&t&&(l.Tb(0,"div",44),l.Ob(1,"app-spb-list-diary",45),l.Sb()),2&t){const t=l.fc().$implicit,e=l.fc(2);l.lc("@detailExpand",t.isExpanded?"expanded":"collapsed"),l.Bb(1),l.lc("diaries",t.diariosBordo)("defects",t.defeitos)("blocks",t.bloqueios)("sprint",e.sprint)("demand",t)}}function Yn(t,e){if(1&t&&(l.Tb(0,"td",36),l.Fc(1,Jn,2,6,"div",43),l.Sb()),2&t){const t=e.$implicit,i=l.fc(2);l.Cb("colspan",i.displayedColumns.length),l.Bb(1),l.lc("ngIf",t.isExpanded)}}function zn(t,e){1&t&&l.Ob(0,"tr",46)}function Vn(t,e){if(1&t){const t=l.Ub();l.Tb(0,"tr",47),l.bc("click",function(){l.xc(t);const i=e.$implicit,n=l.fc(2);return i.isExpanded=!(i.isExpanded&&!n.spbFormsService.sidenav.opened)})("contextmenu",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Sb()}}function Kn(t,e){1&t&&l.Ob(0,"tr",48)}const Wn=function(){return["expandedDetail"]};function Gn(t,e){if(1&t&&(l.Tb(0,"div",7),l.Tb(1,"table",8),l.Rb(2,9),l.Fc(3,ln,1,0,"th",10),l.Fc(4,dn,4,0,"td",11),l.Qb(),l.Rb(5,12),l.Fc(6,bn,1,0,"th",10),l.Fc(7,mn,2,0,"td",13),l.Qb(),l.Rb(8,14),l.Fc(9,un,2,0,"th",10),l.Fc(10,fn,2,1,"td",11),l.Qb(),l.Rb(11,15),l.Fc(12,pn,2,0,"th",10),l.Fc(13,hn,4,3,"td",11),l.Qb(),l.Rb(14,16),l.Fc(15,Sn,2,0,"th",10),l.Fc(16,vn,2,1,"td",11),l.Qb(),l.Rb(17,17),l.Fc(18,gn,2,0,"th",10),l.Fc(19,Fn,2,1,"td",11),l.Qb(),l.Rb(20,18),l.Fc(21,Tn,2,0,"th",10),l.Fc(22,wn,2,1,"td",19),l.Qb(),l.Rb(23,20),l.Fc(24,Cn,2,0,"th",10),l.Fc(25,Dn,2,1,"td",11),l.Qb(),l.Rb(26,21),l.Fc(27,xn,2,0,"th",10),l.Fc(28,In,2,1,"td",11),l.Qb(),l.Rb(29,22),l.Fc(30,En,2,0,"th",10),l.Fc(31,Bn,3,3,"td",11),l.Qb(),l.Rb(32,23),l.Fc(33,On,2,0,"th",10),l.Fc(34,Rn,3,3,"td",11),l.Qb(),l.Rb(35,24),l.Fc(36,Nn,2,0,"th",10),l.Fc(37,Mn,3,3,"td",11),l.Qb(),l.Rb(38,25),l.Fc(39,kn,2,0,"th",10),l.Fc(40,Hn,3,3,"td",11),l.Qb(),l.Rb(41,26),l.Fc(42,yn,2,0,"th",10),l.Fc(43,_n,3,4,"td",11),l.Qb(),l.Rb(44,27),l.Fc(45,qn,2,0,"th",10),l.Fc(46,An,3,4,"td",11),l.Qb(),l.Rb(47,28),l.Fc(48,Pn,2,0,"th",10),l.Fc(49,Qn,3,4,"td",11),l.Qb(),l.Rb(50,29),l.Fc(51,Ln,2,0,"th",10),l.Fc(52,$n,3,4,"td",11),l.Qb(),l.Rb(53,30),l.Fc(54,jn,2,0,"th",10),l.Fc(55,Un,3,4,"td",11),l.Qb(),l.Rb(56,31),l.Fc(57,Yn,2,2,"td",11),l.Qb(),l.Fc(58,zn,1,0,"tr",32),l.Fc(59,Vn,1,0,"tr",33),l.Fc(60,Kn,1,0,"tr",34),l.Sb(),l.Sb()),2&t){const t=l.fc();l.Bb(1),l.lc("dataSource",t.dataSource),l.Bb(57),l.lc("matHeaderRowDef",t.displayedColumns),l.Bb(1),l.lc("matRowDefColumns",t.displayedColumns),l.Bb(1),l.lc("matRowDefColumns",l.nc(4,Wn))}}function Xn(t,e){1&t&&l.Ob(0,"app-simple-message",49)}const Zn=function(t){return{item:t}};function to(t,e){if(1&t){const t=l.Ub();l.Rb(0),l.Tb(1,"button",51),l.bc("click",function(){l.xc(t);const e=l.fc().item,i=l.fc();return i.openNewForm(i.typeForm.STORY,!1,e)}),l.Tb(2,"mat-icon"),l.Hc(3,"remove_red_eye"),l.Sb(),l.Hc(4," Visualizar story "),l.Sb(),l.Tb(5,"button",51),l.bc("click",function(){l.xc(t);const e=l.fc().item,i=l.fc();return i.openNewForm(i.typeForm.STORY,!0,e)}),l.Tb(6,"mat-icon"),l.Hc(7,"edit"),l.Sb(),l.Hc(8," Editar story "),l.Sb(),l.Tb(9,"button",52),l.Tb(10,"mat-icon"),l.Hc(11,"more_vert"),l.Sb(),l.Hc(12," Mais op\xe7\xf5es "),l.Sb(),l.Ob(13,"mat-divider"),l.Qb()}if(2&t){const t=l.fc().item;l.fc();const e=l.uc(8);l.Bb(9),l.lc("matMenuTriggerFor",e)("matMenuTriggerData",l.oc(2,Zn,t))}}function eo(t,e){if(1&t){const t=l.Ub();l.Fc(0,to,14,4,"ng-container",50),l.Tb(1,"button",51),l.bc("click",function(){l.xc(t);const e=l.fc();return e.openNewForm(e.typeForm.STORY,!0)}),l.Tb(2,"mat-icon"),l.Hc(3,"add_circle_outline"),l.Sb(),l.Hc(4," Nova story "),l.Sb()}2&t&&l.lc("ngIf",e.item)}function io(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",51),l.bc("click",function(){l.xc(t);const e=l.fc().item;return l.fc().openRisksModal(e)}),l.Hc(1,"Riscos"),l.Sb()}}function no(t,e){if(1&t&&l.Fc(0,io,2,0,"button",53),2&t){const t=l.fc();l.lc("ngIf",t.riskMode)}}let oo=(()=>{class t{constructor(t,e,i,n,o,c,a,s,r,l,d){this.modalService=t,this.utilsService=e,this.paramsService=i,this.loadingService=n,this.risksService=o,this.simpleRisksService=c,this.demandService=a,this.messageService=s,this.loggedUserService=r,this.risksTypesService=l,this.spbFormsService=d,this.stories=[],this.displayedColumns=["actions","icon","rowNumber","nivelRisco","statusDemanda.descricao","storyNumber","titulo","desenvolvedor.nome","tecnologia.descricao","horasEstimadas","incurridoTotal","etcc","etcm","dtRecebimento","dtEntrada","dtEntregaAcordada","dtInicioReal","dtFimReal"],this.contextMenuPosition=new k.a,this.unsubscribeNotifier=new A.a}ngOnInit(){this.typeForm=me,this.dataSource=new _.k(this.stories),this.getRiskMode(),this.listenOnSaveSpbForms(),this.listenToRiskChanges()}ngOnDestroy(){this.unsubscribeNotifier.next(),this.unsubscribeNotifier.complete()}listenToRiskChanges(){Object(P.a)(this.risksService.risksChanges,this.simpleRisksService.risksChanges).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{const e=this.stories.findIndex(e=>e.demanda_id===t.item.demanda.demanda_id);e>-1&&(this.loadingService.show(),this.demandService.getById(t.item.demanda.demanda_id).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>this.stories[e].nivelRisco=t.nivelRisco,()=>this.messageService.snackMessage("Erro ao atualizar a demanda, atualize a p\xe1gina!","error")).add(()=>this.loadingService.hide()))})}onContextMenu(t,e){this.contextMenuPosition=this.utilsService.openContextMenu(t,this.contextMenu,{item:e})}openNewForm(t,e,i){this.spbFormsService.openForm(t,i,e,{sprint:this.sprint,squad:this.squad})}listenOnSaveSpbForms(){this.spbFormsService.onSave.pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{if(t.type===me.STORY&&t.item.sprint.sprint_id===this.sprint.sprint_id){if(t.item.statusDemanda=t.item.status_demanda,t.item.desenvolvedor=t.item.desenvolvedor,t.action===c.a.CREATED)this.stories.push(t.item);else if(t.action===c.a.UPDATED){const e=this.stories.findIndex(e=>e.demanda_id===t.item.demanda_id);this.utilsService.setValueAtItem(this.stories[e],t.item)}this.dataSource=new _.k(this.stories)}})}openRisksModal(t){this.riskMode===M.a.COMPLETE?this.modalService.open(B.a,{demand:t}):this.riskMode===M.a.SIMPLE&&this.modalService.open(E.a,{demand:t})}getRiskMode(){this.loadingService.show(),this.paramsService.getParamByLineAndKey(this.loggedUserService.getLineId(),"PR_DEMANDA_TIPO_RISCO").pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>this.riskMode=t[0]&&t[0].valor===M.a.COMPLETE?M.a.COMPLETE:M.a.SIMPLE,()=>this.messageService.snackMessage("Erro ao riscos!","error")).add(()=>this.loadingService.hide())}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(z.a),l.Nb($.a),l.Nb(J.a),l.Nb(p.a),l.Nb(U.a),l.Nb(Y.a),l.Nb(Q.a),l.Nb(L.a),l.Nb(V.a),l.Nb(K.a),l.Nb(be))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-spb-list-stories"]],viewQuery:function(t,e){if(1&t&&l.Lc(q.e,!0),2&t){let t;l.tc(t=l.cc())&&(e.contextMenu=t.first)}},inputs:{stories:"stories",squad:"squad",sprint:"sprint"},decls:10,vars:7,consts:[[3,"contextmenu"],["class","wrapper-table-scrolling without-max-height",4,"ngIf"],["message","Nenhuma story encontrada. Clique com o bot\xe3o direito para criar uma nova :)",4,"ngIf"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["contextMenu","matMenu"],["matMenuContent",""],["moreOptionsMenu","matMenu"],[1,"wrapper-table-scrolling","without-max-height"],["mat-table","","multiTemplateDataRows","",3,"dataSource"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","icon"],["mat-cell","","class","auto-width-column",4,"matCellDef"],["matColumnDef","rowNumber"],["matColumnDef","nivelRisco"],["matColumnDef","statusDemanda.descricao"],["matColumnDef","storyNumber"],["matColumnDef","titulo"],["mat-cell","","class","font-weight-bold",4,"matCellDef"],["matColumnDef","desenvolvedor.nome"],["matColumnDef","tecnologia.descricao"],["matColumnDef","horasEstimadas"],["matColumnDef","incurridoTotal"],["matColumnDef","etcc"],["matColumnDef","etcm"],["matColumnDef","dtRecebimento"],["matColumnDef","dtEntrada"],["matColumnDef","dtEntregaAcordada"],["matColumnDef","dtInicioReal"],["matColumnDef","dtFimReal"],["matColumnDef","expandedDetail"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","element-row",3,"click","contextmenu",4,"matRowDef","matRowDefColumns"],["mat-row","","class","detail-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-cell","",1,"auto-width-column"],["src","assets/icon/task.png","alt","Story","matTooltip","Story",1,"icon"],["fxLayoutAlign","start center"],[3,"matTooltip"],["mat-cell","",1,"font-weight-bold"],["class","row-detail",4,"ngIf"],[1,"row-detail"],[3,"diaries","defects","blocks","sprint","demand"],["mat-header-row",""],["mat-row","",1,"element-row",3,"click","contextmenu"],["mat-row","",1,"detail-row"],["message","Nenhuma story encontrada. Clique com o bot\xe3o direito para criar uma nova :)"],[4,"ngIf"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor","matMenuTriggerData"],["mat-menu-item","",3,"click",4,"ngIf"]],template:function(t,e){if(1&t&&(l.Tb(0,"div",0),l.bc("contextmenu",function(t){return e.onContextMenu(t)}),l.Fc(1,Gn,61,5,"div",1),l.Fc(2,Xn,1,0,"app-simple-message",2),l.Ob(3,"div",3),l.Sb(),l.Tb(4,"mat-menu",null,4),l.Fc(6,eo,5,1,"ng-template",5),l.Sb(),l.Tb(7,"mat-menu",null,6),l.Fc(9,no,1,1,"ng-template",5),l.Sb()),2&t){const t=l.uc(5);l.Bb(1),l.lc("ngIf",(null==e.dataSource?null:e.dataSource.data.length)>0),l.Bb(1),l.lc("ngIf",0==(null==e.dataSource?null:e.dataSource.data.length)),l.Bb(1),l.Cc("left",e.contextMenuPosition.x)("top",e.contextMenuPosition.y),l.lc("matMenuTriggerFor",t)}},directives:[o.l,q.e,q.a,q.b,_.j,_.c,_.e,_.b,_.g,_.i,_.d,_.a,X.b,Z.a,et.a,W.a,rn,_.f,_.h,I.a,q.c,at.a],pipes:[st.a,o.e],styles:["tr[_ngcontent-%COMP%]   .element-row[_ngcontent-%COMP%]:hover{background:#f5f5f5;cursor:pointer}tr[_ngcontent-%COMP%]   .element-row.detail-row[_ngcontent-%COMP%]{height:0}tr[_ngcontent-%COMP%]   .element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}tr[_ngcontent-%COMP%]   .element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .row-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}app-spb-list-diary[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]{background:rgba(0,0,0,.0196078431372549)}"],data:{animation:[Object(he.m)("detailExpand",[Object(he.j)("collapsed",Object(he.k)({height:"0px",minHeight:"0"})),Object(he.j)("expanded",Object(he.k)({height:"*"})),Object(he.l)("expanded <=> collapsed",Object(he.e)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),t})();function co(t,e){1&t&&l.Ob(0,"th",23)}function ao(t,e){if(1&t){const t=l.Ub();l.Tb(0,"td",24),l.Tb(1,"button",25),l.bc("click",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Tb(2,"mat-icon"),l.Hc(3,"more_vert"),l.Sb(),l.Sb(),l.Sb()}}function so(t,e){1&t&&l.Ob(0,"th",23)}function ro(t,e){1&t&&(l.Tb(0,"td",26),l.Ob(1,"img",27),l.Sb())}function lo(t,e){1&t&&(l.Tb(0,"th",23),l.Hc(1,"#"),l.Sb())}function bo(t,e){if(1&t&&(l.Tb(0,"td",24),l.Hc(1),l.Sb()),2&t){const t=e.dataIndex;l.Bb(1),l.Jc(" ",t+1," ")}}function mo(t,e){1&t&&(l.Tb(0,"th",23),l.Hc(1,"N\xfamero"),l.Sb())}function uo(t,e){if(1&t&&(l.Tb(0,"td",24),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.sprintNumber)}}function fo(t,e){1&t&&(l.Tb(0,"th",23),l.Hc(1,"T\xedtulo"),l.Sb())}function po(t,e){if(1&t&&(l.Tb(0,"td",28),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.titulo)}}function ho(t,e){1&t&&(l.Tb(0,"th",23),l.Hc(1,"In\xedcio"),l.Sb())}function So(t,e){if(1&t&&(l.Tb(0,"td",24),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtInicio,"dd/MM/yy")," ")}}function vo(t,e){1&t&&(l.Tb(0,"th",23),l.Hc(1,"Fim"),l.Sb())}function go(t,e){if(1&t&&(l.Tb(0,"td",24),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtFim,"dd/MM/yy")," ")}}function Fo(t,e){if(1&t&&(l.Tb(0,"div",30),l.Ob(1,"app-spb-list-stories",31),l.Sb()),2&t){const t=l.fc().$implicit,e=l.fc(2);l.lc("@detailExpand",t.isExpanded?"expanded":"collapsed"),l.Bb(1),l.lc("stories",t.demandas)("sprint",t)("squad",e.release.squad)}}function To(t,e){if(1&t&&(l.Tb(0,"td",24),l.Fc(1,Fo,2,4,"div",29),l.Sb()),2&t){const t=e.$implicit,i=l.fc(2);l.Cb("colspan",i.displayedColumns.length),l.Bb(1),l.lc("ngIf",t.isExpanded)}}function wo(t,e){1&t&&l.Ob(0,"tr",32)}function Co(t,e){if(1&t){const t=l.Ub();l.Tb(0,"tr",33),l.bc("click",function(){l.xc(t);const i=e.$implicit,n=l.fc(2);return i.isExpanded=!(i.isExpanded&&!n.spbFormsService.sidenav.opened)})("contextmenu",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Sb()}}function Do(t,e){1&t&&l.Ob(0,"tr",34)}const xo=function(){return["expandedDetail"]};function Io(t,e){if(1&t&&(l.Tb(0,"div",6),l.Tb(1,"table",7),l.Rb(2,8),l.Fc(3,co,1,0,"th",9),l.Fc(4,ao,4,0,"td",10),l.Qb(),l.Rb(5,11),l.Fc(6,so,1,0,"th",9),l.Fc(7,ro,2,0,"td",12),l.Qb(),l.Rb(8,13),l.Fc(9,lo,2,0,"th",9),l.Fc(10,bo,2,1,"td",10),l.Qb(),l.Rb(11,14),l.Fc(12,mo,2,0,"th",9),l.Fc(13,uo,2,1,"td",10),l.Qb(),l.Rb(14,15),l.Fc(15,fo,2,0,"th",9),l.Fc(16,po,2,1,"td",16),l.Qb(),l.Rb(17,17),l.Fc(18,ho,2,0,"th",9),l.Fc(19,So,3,4,"td",10),l.Qb(),l.Rb(20,18),l.Fc(21,vo,2,0,"th",9),l.Fc(22,go,3,4,"td",10),l.Qb(),l.Rb(23,19),l.Fc(24,To,2,2,"td",10),l.Qb(),l.Fc(25,wo,1,0,"tr",20),l.Fc(26,Co,1,0,"tr",21),l.Fc(27,Do,1,0,"tr",22),l.Sb(),l.Sb()),2&t){const t=l.fc();l.Bb(1),l.lc("dataSource",t.dataSource),l.Bb(24),l.lc("matHeaderRowDef",t.displayedColumns),l.Bb(1),l.lc("matRowDefColumns",t.displayedColumns),l.Bb(1),l.lc("matRowDefColumns",l.nc(4,xo))}}function Eo(t,e){1&t&&l.Ob(0,"app-simple-message",35)}function Bo(t,e){if(1&t){const t=l.Ub();l.Rb(0),l.Tb(1,"button",37),l.bc("click",function(){l.xc(t);const e=l.fc().item,i=l.fc();return i.openNewForm(i.typeForm.SPRINT,!1,e)}),l.Tb(2,"mat-icon"),l.Hc(3,"remove_red_eye"),l.Sb(),l.Hc(4," Visualizar sprint "),l.Sb(),l.Tb(5,"button",37),l.bc("click",function(){l.xc(t);const e=l.fc().item,i=l.fc();return i.openNewForm(i.typeForm.SPRINT,!0,e)}),l.Tb(6,"mat-icon"),l.Hc(7,"edit"),l.Sb(),l.Hc(8," Editar sprint "),l.Sb(),l.Ob(9,"mat-divider"),l.Qb()}}function Oo(t,e){if(1&t){const t=l.Ub();l.Fc(0,Bo,10,0,"ng-container",36),l.Tb(1,"button",37),l.bc("click",function(){l.xc(t);const e=l.fc();return e.openNewForm(e.typeForm.SPRINT,!0)}),l.Tb(2,"mat-icon"),l.Hc(3,"add_circle_outline"),l.Sb(),l.Hc(4," Nova sprint "),l.Sb()}2&t&&l.lc("ngIf",e.item)}let Ro=(()=>{class t{constructor(t,e){this.utilsService=t,this.spbFormsService=e,this.sprints=[],this.displayedColumns=["actions","icon","rowNumber","sprintNumber","titulo","dtInicio","dtFim"],this.contextMenuPosition=new k.a,this.unsubscribeNotifier=new A.a}ngOnInit(){this.typeForm=me,this.dataSource=new _.k(this.sprints),this.listenOnSaveSpbForms()}ngOnDestroy(){this.unsubscribeNotifier.next(),this.unsubscribeNotifier.complete()}onContextMenu(t,e){this.contextMenuPosition=this.utilsService.openContextMenu(t,this.contextMenu,{item:e})}openNewForm(t,e,i){this.spbFormsService.openForm(t,i,e,{release:this.release})}listenOnSaveSpbForms(){this.spbFormsService.onSave.pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{if(t.type===me.SPRINT&&t.item.release.release_id===this.release.release_id){if(t.action===c.a.CREATED)this.sprints.push(t.item);else if(t.action===c.a.UPDATED){const e=this.sprints.findIndex(e=>e.sprint_id===t.item.sprint_id);this.utilsService.setValueAtItem(this.sprints[e],t.item)}this.dataSource=new _.k(this.sprints)}})}}return t.\u0275fac=function(e){return new(e||t)(l.Nb($.a),l.Nb(be))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-spb-list-sprints"]],viewQuery:function(t,e){if(1&t&&l.Lc(q.e,!0),2&t){let t;l.tc(t=l.cc())&&(e.contextMenu=t.first)}},inputs:{sprints:"sprints",release:"release"},decls:7,vars:7,consts:[[3,"contextmenu"],["class","wrapper-table-scrolling without-max-height",4,"ngIf"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["message","Nenhuma sprint encontrada. Clique com o bot\xe3o direito para criar uma nova :)",4,"ngIf"],["contextMenu","matMenu"],["matMenuContent",""],[1,"wrapper-table-scrolling","without-max-height"],["mat-table","","multiTemplateDataRows","",3,"dataSource"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","icon"],["mat-cell","","class","auto-width-column",4,"matCellDef"],["matColumnDef","rowNumber"],["matColumnDef","sprintNumber"],["matColumnDef","titulo"],["mat-cell","","class","font-weight-bold",4,"matCellDef"],["matColumnDef","dtInicio"],["matColumnDef","dtFim"],["matColumnDef","expandedDetail"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","element-row",3,"click","contextmenu",4,"matRowDef","matRowDefColumns"],["mat-row","","class","detail-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-cell","",1,"auto-width-column"],["src","assets/icon/sprint.png","alt","Sprint","matTooltip","Sprint",1,"icon"],["mat-cell","",1,"font-weight-bold"],["class","row-detail",4,"ngIf"],[1,"row-detail"],[3,"stories","sprint","squad"],["mat-header-row",""],["mat-row","",1,"element-row",3,"click","contextmenu"],["mat-row","",1,"detail-row"],["message","Nenhuma sprint encontrada. Clique com o bot\xe3o direito para criar uma nova :)"],[4,"ngIf"],["mat-menu-item","",3,"click"]],template:function(t,e){if(1&t&&(l.Tb(0,"div",0),l.bc("contextmenu",function(t){return e.onContextMenu(t)}),l.Fc(1,Io,28,5,"div",1),l.Ob(2,"div",2),l.Fc(3,Eo,1,0,"app-simple-message",3),l.Sb(),l.Tb(4,"mat-menu",null,4),l.Fc(6,Oo,5,1,"ng-template",5),l.Sb()),2&t){const t=l.uc(5);l.Bb(1),l.lc("ngIf",(null==e.dataSource?null:e.dataSource.data.length)>0),l.Bb(1),l.Cc("left",e.contextMenuPosition.x)("top",e.contextMenuPosition.y),l.lc("matMenuTriggerFor",t),l.Bb(1),l.lc("ngIf",0==(null==e.dataSource?null:e.dataSource.data.length))}},directives:[o.l,q.e,q.a,q.b,_.j,_.c,_.e,_.b,_.g,_.i,_.d,_.a,X.b,Z.a,et.a,oo,_.f,_.h,I.a,q.c,at.a],pipes:[o.e],styles:["tr[_ngcontent-%COMP%]   .element-row[_ngcontent-%COMP%]:hover{background:#f5f5f5;cursor:pointer}tr[_ngcontent-%COMP%]   .element-row.detail-row[_ngcontent-%COMP%]{height:0}tr[_ngcontent-%COMP%]   .element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}tr[_ngcontent-%COMP%]   .element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .row-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}app-spb-list-stories[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]{background:rgba(0,0,0,.0196078431372549)}"],data:{animation:[Object(he.m)("detailExpand",[Object(he.j)("collapsed",Object(he.k)({height:"0px",minHeight:"0"})),Object(he.j)("expanded",Object(he.k)({height:"*"})),Object(he.l)("expanded <=> collapsed",Object(he.e)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),t})();function No(t,e){1&t&&l.Ob(0,"th",24)}function Mo(t,e){if(1&t){const t=l.Ub();l.Tb(0,"td",25),l.Tb(1,"button",26),l.bc("click",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Tb(2,"mat-icon"),l.Hc(3,"more_vert"),l.Sb(),l.Sb(),l.Sb()}}function ko(t,e){1&t&&l.Ob(0,"th",24)}function Ho(t,e){1&t&&(l.Tb(0,"td",27),l.Ob(1,"img",28),l.Sb())}function yo(t,e){1&t&&(l.Tb(0,"th",24),l.Hc(1,"#"),l.Sb())}function _o(t,e){if(1&t&&(l.Tb(0,"td",25),l.Hc(1),l.Sb()),2&t){const t=e.dataIndex;l.Bb(1),l.Jc(" ",t+1," ")}}function qo(t,e){1&t&&(l.Tb(0,"th",24),l.Hc(1,"N\xfamero"),l.Sb())}function Ao(t,e){if(1&t&&(l.Tb(0,"td",25),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.releaseNumber)}}function Po(t,e){1&t&&(l.Tb(0,"th",24),l.Hc(1,"T\xedtulo"),l.Sb())}function Qo(t,e){if(1&t&&(l.Tb(0,"td",29),l.Hc(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Ic(t.titulo)}}function Lo(t,e){1&t&&(l.Tb(0,"th",24),l.Hc(1,"In\xedcio"),l.Sb())}function $o(t,e){if(1&t&&(l.Tb(0,"td",25),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtInicio,"dd/MM/yy")," ")}}function jo(t,e){1&t&&(l.Tb(0,"th",24),l.Hc(1,"Fim"),l.Sb())}function Uo(t,e){if(1&t&&(l.Tb(0,"td",25),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtFim,"dd/MM/yy")," ")}}function Jo(t,e){1&t&&(l.Tb(0,"th",24),l.Hc(1,"Implanta\xe7\xe3o"),l.Sb())}function Yo(t,e){if(1&t&&(l.Tb(0,"td",25),l.Hc(1),l.gc(2,"date"),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Jc(" ",l.ic(2,1,t.dtImplantacao,"dd/MM/yy")," ")}}function zo(t,e){if(1&t&&(l.Tb(0,"div",31),l.Ob(1,"app-spb-list-sprints",32),l.Sb()),2&t){const t=l.fc().$implicit;l.lc("@detailExpand",t.isExpanded?"expanded":"collapsed"),l.Bb(1),l.lc("sprints",t.sprints)("release",t)}}function Vo(t,e){if(1&t&&(l.Tb(0,"td",25),l.Fc(1,zo,2,3,"div",30),l.Sb()),2&t){const t=e.$implicit,i=l.fc(2);l.Cb("colspan",i.displayedColumns.length),l.Bb(1),l.lc("ngIf",t.isExpanded)}}function Ko(t,e){1&t&&l.Ob(0,"tr",33)}function Wo(t,e){if(1&t){const t=l.Ub();l.Tb(0,"tr",34),l.bc("click",function(){l.xc(t);const i=e.$implicit,n=l.fc(2);return i.isExpanded=!(i.isExpanded&&!n.spbFormsService.sidenav.opened)})("contextmenu",function(i){l.xc(t);const n=e.$implicit;return l.fc(2).onContextMenu(i,n)}),l.Sb()}}function Go(t,e){1&t&&l.Ob(0,"tr",35)}const Xo=function(){return["expandedDetail"]};function Zo(t,e){if(1&t&&(l.Tb(0,"div",6),l.Tb(1,"table",7),l.Rb(2,8),l.Fc(3,No,1,0,"th",9),l.Fc(4,Mo,4,0,"td",10),l.Qb(),l.Rb(5,11),l.Fc(6,ko,1,0,"th",9),l.Fc(7,Ho,2,0,"td",12),l.Qb(),l.Rb(8,13),l.Fc(9,yo,2,0,"th",9),l.Fc(10,_o,2,1,"td",10),l.Qb(),l.Rb(11,14),l.Fc(12,qo,2,0,"th",9),l.Fc(13,Ao,2,1,"td",10),l.Qb(),l.Rb(14,15),l.Fc(15,Po,2,0,"th",9),l.Fc(16,Qo,2,1,"td",16),l.Qb(),l.Rb(17,17),l.Fc(18,Lo,2,0,"th",9),l.Fc(19,$o,3,4,"td",10),l.Qb(),l.Rb(20,18),l.Fc(21,jo,2,0,"th",9),l.Fc(22,Uo,3,4,"td",10),l.Qb(),l.Rb(23,19),l.Fc(24,Jo,2,0,"th",9),l.Fc(25,Yo,3,4,"td",10),l.Qb(),l.Rb(26,20),l.Fc(27,Vo,2,2,"td",10),l.Qb(),l.Fc(28,Ko,1,0,"tr",21),l.Fc(29,Wo,1,0,"tr",22),l.Fc(30,Go,1,0,"tr",23),l.Sb(),l.Sb()),2&t){const t=l.fc();l.Bb(1),l.lc("dataSource",t.dataSource),l.Bb(27),l.lc("matHeaderRowDef",t.displayedColumns),l.Bb(1),l.lc("matRowDefColumns",t.displayedColumns),l.Bb(1),l.lc("matRowDefColumns",l.nc(4,Xo))}}function tc(t,e){1&t&&l.Ob(0,"app-simple-message",36)}function ec(t,e){if(1&t){const t=l.Ub();l.Rb(0),l.Tb(1,"button",38),l.bc("click",function(){l.xc(t);const e=l.fc().item,i=l.fc();return i.openNewForm(i.typeForm.RELEASE,!1,e)}),l.Tb(2,"mat-icon"),l.Hc(3,"remove_red_eye"),l.Sb(),l.Hc(4," Visualizar release "),l.Sb(),l.Tb(5,"button",38),l.bc("click",function(){l.xc(t);const e=l.fc().item,i=l.fc();return i.openNewForm(i.typeForm.RELEASE,!0,e)}),l.Tb(6,"mat-icon"),l.Hc(7,"edit"),l.Sb(),l.Hc(8," Editar release "),l.Sb(),l.Ob(9,"mat-divider"),l.Qb()}}function ic(t,e){if(1&t){const t=l.Ub();l.Fc(0,ec,10,0,"ng-container",37),l.Tb(1,"button",38),l.bc("click",function(){l.xc(t);const e=l.fc();return e.openNewForm(e.typeForm.RELEASE,!0)}),l.Tb(2,"mat-icon"),l.Hc(3,"add_circle_outline"),l.Sb(),l.Hc(4," Nova release "),l.Sb()}2&t&&l.lc("ngIf",e.item)}let nc=(()=>{class t{constructor(t,e){this.utilsService=t,this.spbFormsService=e,this.releases=[],this.displayedColumns=["actions","icon","rowNumber","releaseNumber","titulo","dtInicio","dtFim","dtImplantacao"],this.contextMenuPosition=new k.a,this.unsubscribeNotifier=new A.a}ngOnInit(){this.typeForm=me,this.dataSource=new _.k(this.releases),this.listenOnSaveSpbForms()}ngOnDestroy(){this.unsubscribeNotifier.next(),this.unsubscribeNotifier.complete()}onContextMenu(t,e){this.contextMenuPosition=this.utilsService.openContextMenu(t,this.contextMenu,{item:e})}openNewForm(t,e,i){this.spbFormsService.openForm(t,i,e,{idSquad:this.idSquad})}listenOnSaveSpbForms(){this.spbFormsService.onSave.pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{if(t.type===me.RELEASE){if(t.action===c.a.CREATED)this.releases.push(t.item);else if(t.action===c.a.UPDATED){const e=this.releases.findIndex(e=>e.release_id===t.item.release_id);this.utilsService.setValueAtItem(this.releases[e],t.item)}this.dataSource=new _.k(this.releases)}})}}return t.\u0275fac=function(e){return new(e||t)(l.Nb($.a),l.Nb(be))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-spb-list-releases"]],viewQuery:function(t,e){if(1&t&&l.Lc(q.e,!0),2&t){let t;l.tc(t=l.cc())&&(e.contextMenu=t.first)}},inputs:{releases:"releases",idSquad:"idSquad"},decls:7,vars:7,consts:[[3,"contextmenu"],["class","wrapper-table-scrolling without-max-height",4,"ngIf"],["message","Nenhuma release encontrada. Clique com o bot\xe3o direito para criar uma nova :)",4,"ngIf"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["contextMenu","matMenu"],["matMenuContent",""],[1,"wrapper-table-scrolling","without-max-height"],["mat-table","","multiTemplateDataRows","",3,"dataSource"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","icon"],["mat-cell","","class","auto-width-column",4,"matCellDef"],["matColumnDef","rowNumber"],["matColumnDef","releaseNumber"],["matColumnDef","titulo"],["mat-cell","","class","font-weight-bold",4,"matCellDef"],["matColumnDef","dtInicio"],["matColumnDef","dtFim"],["matColumnDef","dtImplantacao"],["matColumnDef","expandedDetail"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","element-row",3,"click","contextmenu",4,"matRowDef","matRowDefColumns"],["mat-row","","class","detail-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-cell","",1,"auto-width-column"],["src","assets/icon/release.png","alt","Release","matTooltip","Release",1,"icon"],["mat-cell","",1,"font-weight-bold"],["class","row-detail",4,"ngIf"],[1,"row-detail"],[3,"sprints","release"],["mat-header-row",""],["mat-row","",1,"element-row",3,"click","contextmenu"],["mat-row","",1,"detail-row"],["message","Nenhuma release encontrada. Clique com o bot\xe3o direito para criar uma nova :)"],[4,"ngIf"],["mat-menu-item","",3,"click"]],template:function(t,e){if(1&t&&(l.Tb(0,"div",0),l.bc("contextmenu",function(t){return e.onContextMenu(t)}),l.Fc(1,Zo,31,5,"div",1),l.Fc(2,tc,1,0,"app-simple-message",2),l.Ob(3,"div",3),l.Sb(),l.Tb(4,"mat-menu",null,4),l.Fc(6,ic,5,1,"ng-template",5),l.Sb()),2&t){const t=l.uc(5);l.Bb(1),l.lc("ngIf",(null==e.dataSource?null:e.dataSource.data.length)>0),l.Bb(1),l.lc("ngIf",0==(null==e.dataSource?null:e.dataSource.data.length)),l.Bb(1),l.Cc("left",e.contextMenuPosition.x)("top",e.contextMenuPosition.y),l.lc("matMenuTriggerFor",t)}},directives:[o.l,q.e,q.a,q.b,_.j,_.c,_.e,_.b,_.g,_.i,_.d,_.a,X.b,Z.a,et.a,Ro,_.f,_.h,I.a,q.c,at.a],pipes:[o.e],styles:["app-spb-list-sprints[_ngcontent-%COMP%]{width:100%}tr[_ngcontent-%COMP%]   .element-row[_ngcontent-%COMP%]:hover{background:#f5f5f5;cursor:pointer}tr[_ngcontent-%COMP%]   .element-row.detail-row[_ngcontent-%COMP%]{height:0}tr[_ngcontent-%COMP%]   .element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}tr[_ngcontent-%COMP%]   .element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .row-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}"],data:{animation:[Object(he.m)("detailExpand",[Object(he.j)("collapsed",Object(he.k)({height:"0px",minHeight:"0"})),Object(he.j)("expanded",Object(he.k)({height:"*"})),Object(he.l)("expanded <=> collapsed",Object(he.e)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),t})();var oc=i("PQAZ"),cc=i("QEcS"),ac=i("DJTy"),sc=i("RTbq"),rc=i("Xwk/");let lc=(()=>{class t{constructor(t,e,i,n,o,c,a){this.formBuilder=t,this.messageService=e,this.loadingService=i,this.errorHandlerService=n,this.releaseService=o,this.utilsService=c,this.selectDevToViewService=a,this.saveEvent=new l.o,this.closeEvent=new l.o,this.unsubscribeNotifier=new A.a,this.moment=r}ngOnInit(){}ngOnDestroy(){this.unsubscribeNotifier.next(),this.unsubscribeNotifier.complete()}ngOnChanges(){this.personId=this.selectDevToViewService.getViewLikeDevId(),this.createForm(),this.item&&this.getItem()}createForm(){this.form=this.formBuilder.group({ativo:[!0],descricao:[null],dtFim:[null,[u.t.required]],dtImplantacao:[null],dtInicio:[r().format("YYYY-MM-DD"),[u.t.required]],releaseNumber:[null,[u.t.required]],squad:this.formBuilder.group({squad_id:[{value:this.idSquad?this.idSquad:null,disabled:!0},[u.t.required]]}),titulo:[null,[u.t.required,u.t.maxLength(200)]]}),this.formEnabled||this.form.disable()}getItem(){this.loadingService.show(),this.releaseService.getById(this.item.release_id).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>this.form.setValue({ativo:t.ativo,descricao:t.descricao,dtFim:t.dtFim,dtImplantacao:t.dtImplantacao,dtInicio:t.dtInicio,squad:{squad_id:t.squad.squad_id},releaseNumber:t.releaseNumber,titulo:t.titulo}),()=>this.messageService.snackMessage("Erro ao visualizar release!","error")).add(()=>this.loadingService.hide())}save(){this.utilsService.validAbstractControl(this.form)&&(this.item?this.update():this.create())}create(){this.loadingService.show(),this.releaseService.create(this.form.getRawValue()).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{this.messageService.snackMessage("Release cadastrada com sucesso!","success"),this.saveEvent.emit({action:c.a.CREATED,item:t})},t=>this.errorHandlerService.handleError(t,"N\xe3o foi poss\xedvel cadastrar a release!")).add(()=>this.loadingService.hide())}update(){const t=Object.assign({},this.form.getRawValue());t.release_id=this.item.release_id,this.loadingService.show(),this.releaseService.update(this.item.release_id,t).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{this.messageService.snackMessage("Release atualizada com sucesso!","success"),this.saveEvent.emit({action:c.a.UPDATED,item:t})},t=>this.errorHandlerService.handleError(t,"N\xe3o foi poss\xedvel atualizar a release!")).add(()=>this.loadingService.hide())}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(u.d),l.Nb(L.a),l.Nb(p.a),l.Nb(ve.a),l.Nb(oc.a),l.Nb($.a),l.Nb(f.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-release-form"]],inputs:{item:"item",formEnabled:"formEnabled",idSquad:"idSquad"},outputs:{saveEvent:"saveEvent",closeEvent:"closeEvent"},features:[l.zb],decls:33,vars:15,consts:[[3,"formGroup"],[1,"container-fluid"],[1,"row"],[1,"col-12"],[3,"control","idDev"],["appearance","outline","color","primary"],["matInput","","formControlName","releaseNumber","appUppercase","","appTrim",""],[3,"control"],["matInput","","formControlName","titulo","appUppercase","","appTrim",""],["matInput","","formControlName","descricao","appTrim",""],["label","Data in\xedcio",3,"control","min","max"],["label","Data fim",3,"control","min","max"],["label","Data implanta\xe7\xe3o",3,"control","min"],["backButtonLabel","FECHAR",3,"showSaveButton","saveEvent","backEvent"]],template:function(t,e){1&t&&(l.Tb(0,"form",0),l.Tb(1,"div",1),l.Tb(2,"div",2),l.Tb(3,"div",3),l.Ob(4,"app-select-allocation-squad",4),l.Sb(),l.Tb(5,"div",3),l.Tb(6,"mat-form-field",5),l.Tb(7,"mat-label"),l.Hc(8,"N\xfamero da release"),l.Sb(),l.Ob(9,"input",6),l.Tb(10,"mat-error"),l.Ob(11,"app-input-errors",7),l.Sb(),l.Sb(),l.Sb(),l.Tb(12,"div",3),l.Tb(13,"mat-form-field",5),l.Tb(14,"mat-label"),l.Hc(15,"T\xedtulo"),l.Sb(),l.Ob(16,"input",8),l.Tb(17,"mat-error"),l.Ob(18,"app-input-errors",7),l.Sb(),l.Sb(),l.Sb(),l.Tb(19,"div",3),l.Tb(20,"mat-form-field",5),l.Tb(21,"mat-label"),l.Hc(22,"Descri\xe7\xe3o"),l.Sb(),l.Ob(23,"textarea",9),l.Tb(24,"mat-error"),l.Ob(25,"app-input-errors",7),l.Sb(),l.Sb(),l.Sb(),l.Tb(26,"div",3),l.Ob(27,"app-input-datepicker",10),l.Sb(),l.Tb(28,"div",3),l.Ob(29,"app-input-datepicker",11),l.Sb(),l.Tb(30,"div",3),l.Ob(31,"app-input-datepicker",12),l.Sb(),l.Sb(),l.Tb(32,"app-footer-form-buttons",13),l.bc("saveEvent",function(){return e.save()})("backEvent",function(){return e.closeEvent.emit()}),l.Sb(),l.Sb(),l.Sb()),2&t&&(l.lc("formGroup",e.form),l.Bb(4),l.lc("control",e.form.get("squad").get("squad_id"))("idDev",e.personId),l.Bb(7),l.lc("control",e.form.get("releaseNumber")),l.Bb(7),l.lc("control",e.form.get("titulo")),l.Bb(7),l.lc("control",e.form.get("descricao")),l.Bb(2),l.lc("control",e.form.get("dtInicio"))("min",e.form.get("dtEntrada")?e.form.get("dtEntrada").value:null)("max",e.form.get("dtFim").value?e.form.get("dtFim").value:e.form.get("dtImplantacao").value?e.form.get("dtImplantacao").value:null),l.Bb(2),l.lc("control",e.form.get("dtFim"))("min",e.form.get("dtInicio").value)("max",e.form.get("dtImplantacao").value),l.Bb(2),l.lc("control",e.form.get("dtImplantacao"))("min",e.form.get("dtFim").value?e.form.get("dtFim").value:e.form.get("dtInicio").value?e.form.get("dtInicio").value:null),l.Bb(1),l.lc("showSaveButton",e.formEnabled))},directives:[u.u,u.p,u.h,h.a,it.c,it.f,nt.b,u.c,u.o,u.g,cc.a,ac.a,it.b,sc.a,T.a,rc.a],styles:[""]}),t})();var dc=i("az1W");let bc=(()=>{class t{constructor(t,e,i,n,o,c){this.formBuilder=t,this.messageService=e,this.loadingService=i,this.errorHandlerService=n,this.sprintService=o,this.utilsService=c,this.saveEvent=new l.o,this.closeEvent=new l.o,this.moment=r,this.unsubscribeNotifier=new A.a}ngOnInit(){}ngOnDestroy(){this.unsubscribeNotifier.next(),this.unsubscribeNotifier.complete()}ngOnChanges(){this.createForm(),this.item&&this.getItem()}createForm(){this.form=this.formBuilder.group({ativo:[!0],descricao:[null],dtFim:[null,[u.t.required]],dtInicio:[null,[u.t.required]],release:this.formBuilder.group({release_id:[{value:this.release?this.release.release_id:null,disabled:!0},[u.t.required]],releaseNumber:[{value:this.release?this.release.releaseNumber:null,disabled:!0},[u.t.required]]}),sprintNumber:[null,[u.t.required]],titulo:[null,[u.t.required,u.t.maxLength(200)]]}),this.formEnabled||this.form.disable()}getItem(){this.loadingService.show(),this.sprintService.getById(this.item.sprint_id).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>this.form.setValue({ativo:t.ativo,descricao:t.descricao,dtFim:t.dtFim,dtInicio:t.dtInicio,release:{release_id:t.release.release_id,releaseNumber:t.release.releaseNumber},sprintNumber:t.sprintNumber,titulo:t.titulo}),()=>this.messageService.snackMessage("Erro ao visualizar sprint!","error")).add(()=>this.loadingService.hide())}save(){this.utilsService.validAbstractControl(this.form)&&(this.item?this.update():this.create())}create(){this.loadingService.show(),this.sprintService.create(this.form.getRawValue()).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{this.messageService.snackMessage("Sprint cadastrada com sucesso!","success"),this.saveEvent.emit({action:c.a.CREATED,item:t})},t=>this.errorHandlerService.handleError(t,"N\xe3o foi poss\xedvel cadastrar a sprint!")).add(()=>this.loadingService.hide())}update(){const t=Object.assign({},this.form.getRawValue());t.sprint_id=this.item.sprint_id,this.loadingService.show(),this.sprintService.update(this.item.sprint_id,t).pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(t=>{this.messageService.snackMessage("Sprint atualizada com sucesso!","success"),this.saveEvent.emit({action:c.a.UPDATED,item:t})},t=>this.errorHandlerService.handleError(t,"N\xe3o foi poss\xedvel atualizar a sprint!")).add(()=>this.loadingService.hide())}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(u.d),l.Nb(L.a),l.Nb(p.a),l.Nb(ve.a),l.Nb(dc.a),l.Nb($.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-sprint-form"]],inputs:{item:"item",formEnabled:"formEnabled",release:"release"},outputs:{saveEvent:"saveEvent",closeEvent:"closeEvent"},features:[l.zb],decls:38,vars:15,consts:[[3,"formGroup"],[1,"container-fluid"],[1,"row"],[1,"col-12"],["appearance","outline","color","primary","formGroupName","release"],["matInput","","formControlName","releaseNumber","appUppercase","","appTrim",""],[3,"control"],[3,"control","idSquad","formEnabled"],["appearance","outline","color","primary"],["matInput","","formControlName","sprintNumber","appUppercase","","appTrim",""],["matInput","","formControlName","titulo","appUppercase","","appTrim",""],["matInput","","formControlName","descricao","appTrim",""],["label","Data in\xedcio",3,"control","min","max"],["label","Data fim",3,"control","min","max"],["backButtonLabel","FECHAR",3,"showSaveButton","saveEvent","backEvent"]],template:function(t,e){1&t&&(l.Tb(0,"form",0),l.Tb(1,"div",1),l.Tb(2,"div",2),l.Tb(3,"div",3),l.Tb(4,"mat-form-field",4),l.Tb(5,"mat-label"),l.Hc(6,"N\xfamero da release"),l.Sb(),l.Ob(7,"input",5),l.Tb(8,"mat-error"),l.Ob(9,"app-input-errors",6),l.Sb(),l.Sb(),l.Sb(),l.Tb(10,"div",3),l.Ob(11,"app-select-release",7),l.Sb(),l.Tb(12,"div",3),l.Tb(13,"mat-form-field",8),l.Tb(14,"mat-label"),l.Hc(15,"N\xfamero da sprint"),l.Sb(),l.Ob(16,"input",9),l.Tb(17,"mat-error"),l.Ob(18,"app-input-errors",6),l.Sb(),l.Sb(),l.Sb(),l.Tb(19,"div",3),l.Tb(20,"mat-form-field",8),l.Tb(21,"mat-label"),l.Hc(22,"T\xedtulo"),l.Sb(),l.Ob(23,"input",10),l.Tb(24,"mat-error"),l.Ob(25,"app-input-errors",6),l.Sb(),l.Sb(),l.Sb(),l.Tb(26,"div",3),l.Tb(27,"mat-form-field",8),l.Tb(28,"mat-label"),l.Hc(29,"Descri\xe7\xe3o"),l.Sb(),l.Ob(30,"textarea",11),l.Tb(31,"mat-error"),l.Ob(32,"app-input-errors",6),l.Sb(),l.Sb(),l.Sb(),l.Tb(33,"div",3),l.Ob(34,"app-input-datepicker",12),l.Sb(),l.Tb(35,"div",3),l.Ob(36,"app-input-datepicker",13),l.Sb(),l.Sb(),l.Tb(37,"app-footer-form-buttons",14),l.bc("saveEvent",function(){return e.save()})("backEvent",function(){return e.closeEvent.emit()}),l.Sb(),l.Sb(),l.Sb()),2&t&&(l.lc("formGroup",e.form),l.Bb(9),l.lc("control",e.form.get("releaseNumber")),l.Bb(2),l.lc("control",e.form.get("release").get("release_id"))("idSquad",e.release.squad.squad_id)("formEnabled",e.formEnabled),l.Bb(7),l.lc("control",e.form.get("sprintNumber")),l.Bb(7),l.lc("control",e.form.get("titulo")),l.Bb(7),l.lc("control",e.form.get("descricao")),l.Bb(2),l.lc("control",e.form.get("dtInicio"))("min",e.release.dtInicio)("max",e.form.get("dtFim").value<e.release.dtFim?e.form.get("dtFim").value:e.release.dtFim),l.Bb(2),l.lc("control",e.form.get("dtFim"))("min",e.form.get("dtInicio").value?e.form.get("dtInicio").value:e.release.dtInicio)("max",e.release.dtFim),l.Bb(1),l.lc("showSaveButton",e.formEnabled))},directives:[u.u,u.p,u.h,it.c,u.i,it.f,nt.b,u.c,u.o,u.g,cc.a,ac.a,it.b,sc.a,w.a,T.a,rc.a],styles:[""]}),t})();var mc=i("GdB0"),uc=i("b5/5"),fc=i("kmKX");const pc=["div"];function hc(t,e){if(1&t){const t=l.Ub();l.Rb(0),l.Tb(1,"h6"),l.Hc(2,"Release"),l.Sb(),l.Tb(3,"app-release-form",2),l.bc("closeEvent",function(){return l.xc(t),l.fc().spbFormsService.closeForm()})("saveEvent",function(e){l.xc(t);const i=l.fc();return i.onSave(e,i.typeForms.RELEASE)}),l.Sb(),l.Qb()}if(2&t){const t=l.fc();l.Bb(3),l.lc("item",t.spbFormsService.item)("formEnabled",t.spbFormsService.formEnabled)("idSquad",t.spbFormsService.data.idSquad)}}function Sc(t,e){if(1&t){const t=l.Ub();l.Rb(0),l.Tb(1,"h6"),l.Hc(2,"Sprint"),l.Sb(),l.Tb(3,"app-sprint-form",3),l.bc("closeEvent",function(){return l.xc(t),l.fc().spbFormsService.closeForm()})("saveEvent",function(e){l.xc(t);const i=l.fc();return i.onSave(e,i.typeForms.SPRINT)}),l.Sb(),l.Qb()}if(2&t){const t=l.fc();l.Bb(3),l.lc("item",t.spbFormsService.item)("formEnabled",t.spbFormsService.formEnabled)("release",t.spbFormsService.data.release)}}function vc(t,e){if(1&t){const t=l.Ub();l.Rb(0),l.Tb(1,"h6"),l.Hc(2,"Story"),l.Sb(),l.Tb(3,"app-demands-form",4),l.bc("backEvent",function(){return l.xc(t),l.fc().spbFormsService.closeForm()})("saveEvent",function(e){l.xc(t);const i=l.fc();return i.onSave(e,i.typeForms.STORY)}),l.Sb(),l.Qb()}if(2&t){const t=l.fc();l.Bb(3),l.lc("item",t.spbFormsService.item)("formEnabled",t.spbFormsService.formEnabled)("sprint",t.spbFormsService.data.sprint)("squad",t.spbFormsService.data.squad)("formWithOneColumn",!0)("callBackOnCreateOrUpdate",!1)}}function gc(t,e){if(1&t){const t=l.Ub();l.Rb(0),l.Tb(1,"h6"),l.Hc(2,"Di\xe1rios"),l.Sb(),l.Tb(3,"app-diary-form",5),l.bc("backEvent",function(){return l.xc(t),l.fc().spbFormsService.closeForm()})("saveEvent",function(e){l.xc(t);const i=l.fc();return i.onSave(e,i.typeForms.DIARY)}),l.Sb(),l.Qb()}if(2&t){const t=l.fc();l.Bb(3),l.lc("item",t.spbFormsService.item)("formEnabled",t.spbFormsService.formEnabled)("demand",t.spbFormsService.data.demand)("sprint",t.spbFormsService.data.sprint)("formWithOneColumn",!0)}}function Fc(t,e){if(1&t){const t=l.Ub();l.Rb(0),l.Tb(1,"h6"),l.Hc(2,"Defeitos"),l.Sb(),l.Tb(3,"app-defects-form",5),l.bc("backEvent",function(){return l.xc(t),l.fc().spbFormsService.closeForm()})("saveEvent",function(e){l.xc(t);const i=l.fc();return i.onSave(e,i.typeForms.DEFECT)}),l.Sb(),l.Qb()}if(2&t){const t=l.fc();l.Bb(3),l.lc("item",t.spbFormsService.item)("formEnabled",t.spbFormsService.formEnabled)("demand",t.spbFormsService.data.demand)("sprint",t.spbFormsService.data.sprint)("formWithOneColumn",!0)}}function Tc(t,e){if(1&t){const t=l.Ub();l.Rb(0),l.Tb(1,"h6"),l.Hc(2,"Bloqueio"),l.Sb(),l.Tb(3,"app-blocks-form",5),l.bc("backEvent",function(){return l.xc(t),l.fc().spbFormsService.closeForm()})("saveEvent",function(e){l.xc(t);const i=l.fc();return i.onSave(e,i.typeForms.BLOCK)}),l.Sb(),l.Qb()}if(2&t){const t=l.fc();l.Bb(3),l.lc("item",t.spbFormsService.item)("formEnabled",t.spbFormsService.formEnabled)("demand",t.spbFormsService.data.demand)("sprint",t.spbFormsService.data.sprint)("formWithOneColumn",!0)}}let wc=(()=>{class t{constructor(t){this.spbFormsService=t}ngOnInit(){this.typeForms=me,Object(le.a)(250).pipe(Object(de.a)(1)).subscribe(()=>{this.div.nativeElement.scrollIntoView({behavior:"smooth",block:"start"})})}onSave(t,e){this.spbFormsService.onSave.next({action:t.action,item:t.item,type:e}),this.spbFormsService.closeForm()}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(be))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-spb-forms"]],viewQuery:function(t,e){if(1&t&&l.Lc(pc,!0),2&t){let t;l.tc(t=l.cc())&&(e.div=t.first)}},decls:8,vars:6,consts:[["div",""],[4,"ngIf"],[3,"item","formEnabled","idSquad","closeEvent","saveEvent"],[3,"item","formEnabled","release","closeEvent","saveEvent"],["type","spb",3,"item","formEnabled","sprint","squad","formWithOneColumn","callBackOnCreateOrUpdate","backEvent","saveEvent"],[3,"item","formEnabled","demand","sprint","formWithOneColumn","backEvent","saveEvent"]],template:function(t,e){1&t&&(l.Tb(0,"div",null,0),l.Fc(2,hc,4,3,"ng-container",1),l.Fc(3,Sc,4,3,"ng-container",1),l.Fc(4,vc,4,6,"ng-container",1),l.Fc(5,gc,4,5,"ng-container",1),l.Fc(6,Fc,4,5,"ng-container",1),l.Fc(7,Tc,4,5,"ng-container",1),l.Sb()),2&t&&(l.Bb(2),l.lc("ngIf",e.spbFormsService.typeForm==e.typeForms.RELEASE),l.Bb(1),l.lc("ngIf",e.spbFormsService.typeForm==e.typeForms.SPRINT),l.Bb(1),l.lc("ngIf",e.spbFormsService.typeForm==e.typeForms.STORY),l.Bb(1),l.lc("ngIf",e.spbFormsService.typeForm==e.typeForms.DIARY),l.Bb(1),l.lc("ngIf",e.spbFormsService.typeForm==e.typeForms.DEFECT),l.Bb(1),l.lc("ngIf",e.spbFormsService.typeForm==e.typeForms.BLOCK))},directives:[o.l,lc,bc,ce.a,mc.a,uc.a,fc.a],styles:[""]}),t})();const Cc=["sidenav"];function Dc(t,e){if(1&t&&l.Ob(0,"app-spb-list-releases",6),2&t){const t=l.fc();l.lc("releases",t.result)("idSquad",t.filters.squad_id)}}function xc(t,e){1&t&&l.Ob(0,"app-loading-spinner")}function Ic(t,e){1&t&&l.Ob(0,"app-spb-forms")}const Ec=function(){return{"min-height":"450px"}},Bc=function(){return{}};let Oc=(()=>{class t{constructor(t,e,i,n,o){this.spbWorkBreakdownService=t,this.messageService=e,this.spbFormsService=i,this.footerBarHoursService=n,this.utilsService=o,this.isLoading=!1,this.unsubscribeNotifier=new A.a}ngOnInit(){this.spbFormsService.setSidenav(this.sidenav),this.listenFooterBarHoursChanges()}ngOnDestroy(){this.unsubscribeNotifier.next(),this.unsubscribeNotifier.complete()}ngOnChanges(){this.filters&&this.getWorkBreakdown()}ngAfterViewInit(){this.spbFormsService.setSidenav(this.sidenav)}listenFooterBarHoursChanges(){this.footerBarHoursService.diariesOrEventsChanges.pipe(Object(y.a)(this.unsubscribeNotifier)).subscribe(()=>{this.getWorkBreakdown(),this.spbFormsService.closeForm()})}getWorkBreakdown(){this.isLoading=!0,this.result=[],this.spbWorkBreakdownService.getWorkBreakdown(this.filters).subscribe(t=>{this.result=t||[],this.isLoading=!1},()=>{this.isLoading=!1,this.messageService.snackMessage("Erro ao listar demandas!","error")})}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(re),l.Nb(L.a),l.Nb(be),l.Nb(ue.a),l.Nb($.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-spb-work-breakdown"]],viewQuery:function(t,e){if(1&t&&l.Lc(Cc,!0),2&t){let t;l.tc(t=l.cc())&&(e.sidenav=t.first)}},inputs:{filters:"filters"},features:[l.zb],decls:7,vars:8,consts:[[3,"hasBackdrop"],[3,"ngStyle"],[3,"releases","idSquad",4,"ngIf"],[4,"ngIf"],["position","end",3,"mode"],["sidenav",""],[3,"releases","idSquad"]],template:function(t,e){if(1&t&&(l.Tb(0,"mat-sidenav-container",0),l.Tb(1,"mat-sidenav-content",1),l.Fc(2,Dc,1,2,"app-spb-list-releases",2),l.Fc(3,xc,1,0,"app-loading-spinner",3),l.Sb(),l.Tb(4,"mat-sidenav",4,5),l.Fc(6,Ic,1,0,"app-spb-forms",3),l.Sb(),l.Sb()),2&t){const t=l.uc(5);l.lc("hasBackdrop",!1),l.Bb(1),l.lc("ngStyle",t.opened?l.nc(6,Ec):l.nc(7,Bc)),l.Bb(1),l.lc("ngIf",!e.isLoading),l.Bb(1),l.lc("ngIf",e.isLoading),l.Bb(1),l.lc("mode",e.utilsService.isMobile()?"over":"side"),l.Bb(2),l.lc("ngIf",t.opened)}},directives:[fe.b,fe.c,o.m,pe.b,o.l,fe.a,nc,ct.a,wc],styles:["mat-sidenav-container[_ngcontent-%COMP%]{background:#fff}mat-sidenav-container[_ngcontent-%COMP%]   mat-sidenav[_ngcontent-%COMP%]{width:300px;padding:12px}"]}),t})();function Rc(t,e){if(1&t){const t=l.Ub();l.Tb(0,"app-demand-filters",3),l.bc("filterEvent",function(e){return l.xc(t),l.fc().onFilter(e)})("allocationSquadSelectedChanges",function(e){return l.xc(t),l.fc().onAllocationSquadSelected(e)}),l.Sb()}if(2&t){const t=l.fc();l.lc("defaultFilter",t.filters)}}function Nc(t,e){1&t&&l.Ob(0,"app-simple-message",4)}function Mc(t,e){if(1&t){const t=l.Ub();l.Tb(0,"app-demands-list",9),l.bc("new",function(){return l.xc(t),l.fc(3).create()})("view",function(e){return l.xc(t),l.fc(3).view(e)})("edit",function(e){return l.xc(t),l.fc(3).edit(e)}),l.Sb()}if(2&t){const t=l.fc(3);l.lc("filters",t.filters)("showNewButton",t.showNewButton)("allocationIsActive",t.allocationIsActive())}}function kc(t,e){if(1&t){const t=l.Ub();l.Tb(0,"app-demands-form",10),l.bc("backEvent",function(){return l.xc(t),l.fc(3).back()}),l.Sb()}if(2&t){const t=l.fc(3);l.lc("item",t.item)("formEnabled",t.formEnabled)("type",t.item?t.item.modelo==t.modelSquad.KPB?"kpb":t.item.modelo==t.modelSquad.SPB?"spb":"kpb":"kpb")}}function Hc(t,e){if(1&t&&(l.Rb(0),l.Fc(1,Mc,1,3,"app-demands-list",7),l.Fc(2,kc,1,3,"app-demands-form",8),l.Qb()),2&t){const t=l.fc(2);l.Bb(1),l.lc("ngIf",t.showList),l.Bb(1),l.lc("ngIf",!t.showList)}}function yc(t,e){if(1&t&&l.Ob(0,"app-spb-work-breakdown",11),2&t){const t=l.fc(2);l.lc("filters",t.filters)}}function _c(t,e){1&t&&l.Ob(0,"app-simple-message",12)}function qc(t,e){if(1&t&&(l.Rb(0),l.Fc(1,Hc,3,2,"ng-container",2),l.Fc(2,yc,1,1,"app-spb-work-breakdown",5),l.Fc(3,_c,1,0,"app-simple-message",6),l.Qb()),2&t){const t=l.fc();l.Bb(1),l.lc("ngIf",(null==t.allocationSquadSelected?null:t.allocationSquadSelected.squad.modelo.modelo_id)==t.modelSquad.KPB),l.Bb(1),l.lc("ngIf",(null==t.allocationSquadSelected?null:t.allocationSquadSelected.squad.modelo.modelo_id)==t.modelSquad.SPB),l.Bb(1),l.lc("ngIf",!t.allocationSquadSelected||!(null!=t.allocationSquadSelected&&t.allocationSquadSelected.squad.modelo.modelo_id))}}const Ac=[{path:"",component:(()=>{class t extends s.a{constructor(t,e){super(),this.router=t,this.permissionsService=e,this.showFilters=!0,this.showNewButton=!0,this.modelSquad=a.a,this.currentNavigation=this.router.getCurrentNavigation()}ngOnInit(){}onAllocationSquadSelected(t){this.allocationSquadSelected=t}onFilter(t){if(this.filters=t,this.currentNavigation&&this.currentNavigation.extras&&this.currentNavigation.extras.state){const t=this.currentNavigation.extras.state.action,e=this.currentNavigation.extras.state.item;t===c.a.CREATE?this.create():t===c.a.VIEW&&e?this.view(e):t===c.a.UPDATE&&e&&this.edit(e)}}isFinished(t){if(!t)return!1;const e=r().format("YYYY-MM-DD");return r(t).format("YYYY-MM-DD")<e}allocationIsActive(){return!!this.allocationSquadSelected&&!this.allocationSquadSelected.dtFimAlocacao}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(d.a),l.Nb(b.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-demands"]],inputs:{filters:"filters",showFilters:"showFilters",showNewButton:"showNewButton"},features:[l.yb],decls:3,vars:3,consts:[[3,"defaultFilter","filterEvent","allocationSquadSelectedChanges",4,"ngIf"],["message",'Por favor, selecione ao menos a squad e clique em "Filtrar".',4,"ngIf"],[4,"ngIf"],[3,"defaultFilter","filterEvent","allocationSquadSelectedChanges"],["message",'Por favor, selecione ao menos a squad e clique em "Filtrar".'],[3,"filters",4,"ngIf"],["message","Squad sem um modelo definido.",4,"ngIf"],[3,"filters","showNewButton","allocationIsActive","new","view","edit",4,"ngIf"],[3,"item","formEnabled","type","backEvent",4,"ngIf"],[3,"filters","showNewButton","allocationIsActive","new","view","edit"],[3,"item","formEnabled","type","backEvent"],[3,"filters"],["message","Squad sem um modelo definido."]],template:function(t,e){1&t&&(l.Fc(0,Rc,1,1,"app-demand-filters",0),l.Fc(1,Nc,1,0,"app-simple-message",1),l.Fc(2,qc,4,3,"ng-container",2)),2&t&&(l.lc("ngIf",e.showFilters&&(e.showList||(null==e.allocationSquadSelected?null:e.allocationSquadSelected.squad.modelo.modelo_id)==e.modelSquad.SPB)),l.Bb(1),l.lc("ngIf",!e.filters&&e.showFilters),l.Bb(1),l.lc("ngIf",e.filters))},directives:[o.l,x,I.a,oe,ce.a,Oc],styles:[""]}),t})()}];let Pc=(()=>{class t{}return t.\u0275mod=l.Lb({type:t}),t.\u0275inj=l.Kb({factory:function(e){return new(e||t)},imports:[[d.d.forChild(Ac)],d.d]}),t})();var Qc=i("NATq");let Lc=(()=>{class t{}return t.\u0275mod=l.Lb({type:t}),t.\u0275inj=l.Kb({factory:function(e){return new(e||t)},imports:[[o.c,n.a,Pc,Qc.a]]}),t})()}}]);